"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[3882],{65868:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>i,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>u});var t=s(85893),o=s(11151);const a={sidebar_position:1,tags:["Fastjson"]},r="WAF \u7ed5\u8fc7",c={id:"components/fastjson/bypass",title:"WAF \u7ed5\u8fc7",description:"\u4ee5\u8be5\u7ed3\u6784 User \u5bf9\u8c61\u4e3e\u4f8b\u8bf4\u660e",source:"@site/docs/03-components/01-fastjson/03-bypass.md",sourceDirName:"03-components/01-fastjson",slug:"/components/fastjson/bypass",permalink:"/docs/components/fastjson/bypass",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/03-components/01-fastjson/03-bypass.md",tags:[{label:"Fastjson",permalink:"/docs/tags/fastjson"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["Fastjson"]},sidebar:"tutorialSidebar",previous:{title:"json \u7c7b\u6846\u67b6\u8e29\u70b9\u601d\u8def",permalink:"/docs/components/fastjson/fastjsonCheck"},next:{title:"\u82e5\u4f9d\u5b9a\u65f6\u4efb\u52a1BE Rce",permalink:"/docs/components/ruoyicorntabRCE/"}},i={},u=[{value:"\u7f16\u7801\u7ed5\u8fc7",id:"\u7f16\u7801\u7ed5\u8fc7",level:2},{value:"\u5b57\u7b26\u586b\u5145",id:"\u5b57\u7b26\u586b\u5145",level:2}];function l(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,o.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"waf-\u7ed5\u8fc7",children:"WAF \u7ed5\u8fc7"}),"\n",(0,t.jsx)(e.p,{children:"\u4ee5\u8be5\u7ed3\u6784 User \u5bf9\u8c61\u4e3e\u4f8b\u8bf4\u660e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"&User {\n\tusername: 1\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n  "@type": "org.example.User",\n  "username": "1"\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u7f16\u7801\u7ed5\u8fc7",children:"\u7f16\u7801\u7ed5\u8fc7"}),"\n",(0,t.jsx)(e.p,{children:"fastjson \u5bf9 key,value \u503c\u4f1a\u81ea\u52a8\u8fdb\u884c hex \u89e3\u7801\u548c unicode\u89e3\u7801"}),"\n",(0,t.jsx)(e.p,{children:"hex"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n  "\\x40\\x74\\x79\\x70\\x65": "\\x6f\\x72\\x67\\x2e\\x65\\x78\\x61\\x6d\\x70\\x6c\\x65\\x2e\\x55\\x73\\x65\\x72",\n  "username": "1"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"unicode"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n  "@type": "\\u006f\\u0072\\u0067\\u002e\\u0065\\u0078\\u0061\\u006d\\u0070\\u006c\\u0065\\u002e\\u0055\\u0073\\u0065\\u0072",\n  "username": "1"\n}\n\n{\n  "\\u0040\\u0074\\u0079\\u0070\\u0065": "\\u006f\\u0072\\u0067\\u002e\\u0065\\u0078\\u0061\\u006d\\u0070\\u006c\\u0065\\u002e\\u0055\\u0073\\u0065\\u0072",\n  "username": "1"\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u5b57\u7b26\u586b\u5145",children:"\u5b57\u7b26\u586b\u5145"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n  "@type": "org.example.User",\n  "username": "1",\n  "f": "a*20000"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4e8c\u6b21\u53cd\u5e8f\u5217\u5316"}),"\n",(0,t.jsx)(e.p,{children:"$ref"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://www.bmth666.cn/bmth_blog/2022/04/11/Fastjson%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/#%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0",children:"http://www.bmth666.cn/bmth_blog/2022/04/11/Fastjson%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/#%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0"})}),"\n",(0,t.jsx)(e.p,{children:"\u7f16\u7801"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://blog.csdn.net/fmyyy1/article/details/121674546",children:"https://blog.csdn.net/fmyyy1/article/details/121674546"})}),"\n",(0,t.jsx)(e.p,{children:"\u7ed5\u8fc7 WAF \uff0c\u5728\u90e8\u5206\u4e2d\u95f4\u4ef6\u4e2d\uff0cmultipart \u652f\u6301\u6307\u5b9a Content-Transformer-Encoding \u53ef\u4ee5\u4f7f\u7528 Base64 \u6216 quoted-printable \uff08QP \u7f16\u7801\uff09\n\u6765\u7ed5\u8fc7 WAF"}),"\n",(0,t.jsx)(e.p,{children:"\u5927\u91cf\u5b57\u7b26\u7ed5\u8fc7 WAF"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"[11111111111111111111111111111111111,[11111111111111111111111111111111111... ,[11111111111111111111111111111111111... ,[11111111111111111111111111111111111... ,[11111111111111111111111111111111111... ,...,{'\\x40\\u0074\\x79\\u0070\\x65':xjava.lang.AutoCloseable\"... ]]]]]\n\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5404\u79cd\u7279\u6027"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:",new:[NaN,x'00',{,/*}*/'\\x40\\u0074\\x79\\u0070\\x65':xjava.lang.AutoClosea ble\"\n"})})]})}function d(n={}){const{wrapper:e}={...(0,o.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(l,{...n})}):l(n)}},11151:(n,e,s)=>{s.d(e,{Z:()=>c,a:()=>r});var t=s(67294);const o={},a=t.createContext(o);function r(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);