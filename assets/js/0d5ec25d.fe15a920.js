"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[2874],{19980:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>r});var a=n(85893),c=n(11151);const t={},d="URLDNS",i={id:"PPPYSO/gadgets/URLDNS/URLDNS",title:"URLDNS",description:"0x00 sink",source:"@site/docs/01-PPPYSO/01-gadgets/00-URLDNS/00-URLDNS.md",sourceDirName:"01-PPPYSO/01-gadgets/00-URLDNS",slug:"/PPPYSO/gadgets/URLDNS/",permalink:"/docs/PPPYSO/gadgets/URLDNS/",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/01-PPPYSO/01-gadgets/00-URLDNS/00-URLDNS.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u53cd\u5e8f\u5217\u5316\u8c03\u7528\u94fe\u5206\u6790",permalink:"/docs/category/\u53cd\u5e8f\u5217\u5316\u8c03\u7528\u94fe\u5206\u6790"},next:{title:"CommonsCollections",permalink:"/docs/category/commonscollections"}},o={},r=[{value:"0x00 sink",id:"0x00-sink",level:2},{value:"0x01 source",id:"0x01-source",level:2},{value:"0x02 \u7c7b\u63a2\u6d4b",id:"0x02-\u7c7b\u63a2\u6d4b",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,c.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{id:"urldns",children:"URLDNS"}),"\n",(0,a.jsx)(s.h2,{id:"0x00-sink",children:"0x00 sink"}),"\n",(0,a.jsxs)(s.p,{children:["\u8fd9\u4e2a\u6bd4\u8f83\u7b80\u5355\uff0c\u7f51\u4e0a\u7c7b\u4f3c\u6587\u7ae0\u5f88\u591a\uff0c\u7b80\u8981\u4ecb\u7ecd\u4e00\u4e0b\u3002 ",(0,a.jsx)(s.code,{children:"java.net.URLStreamHandler.getHostAddress()"})," \u65b9\u6cd5\u4f1a\u89e6\u53d1\u4e00\u6b21\u67e5\u8be2\uff0c\u800c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u901a\u8fc7 ",(0,a.jsx)(s.code,{children:"java.net.URL"})," \u7c7b\u7684 ",(0,a.jsx)(s.code,{children:"equals()"})," \u548c ",(0,a.jsx)(s.code,{children:"hashcode()"})," \u65b9\u6cd5\u8c03\u7528\u3002"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"image-20240119092941838",src:n(61512).Z+"",width:"1048",height:"756"})}),"\n",(0,a.jsx)(s.h2,{id:"0x01-source",children:"0x01 source"}),"\n",(0,a.jsxs)(s.p,{children:["soure \u70b9\u9009\u7528 HashMap\uff0c\u5177\u4f53\u539f\u7406\u53ef\u4ee5\u53c2\u8003 ",(0,a.jsx)(s.a,{href:"https://cloud.tencent.com/developer/article/1167574",children:"hashMap\u539f\u7406"})," \u8fd9\u7bc7\u6587\u7ae0\u3002\u603b\u7ed3\u51fa\u5f53\u524d\u5206\u6790\u9700\u8981\u5173\u6ce8\u7684\u70b9 ",(0,a.jsx)(s.code,{children:"put()"})," \u51fd\u6570\u4f1a\u8c03\u7528 ",(0,a.jsx)(s.code,{children:"hashCode()"})," \u8ba1\u7b97 key \u7684 hash\uff0c\u7136\u540e\u518d\u8ba1\u7b97index\u3002"]}),"\n",(0,a.jsxs)(s.p,{children:["\u800c\u5728 HashMap \u7684 ",(0,a.jsx)(s.code,{children:"readObject()"})," \u4e2d\u8c03\u7528 ",(0,a.jsx)(s.code,{children:"putVal()"})," \u8ba1\u7b97 key \u7684 hash\uff0c\u6240\u4ee5\u7528\u6765\u89e6\u53d1\u3002"]}),"\n",(0,a.jsx)(s.p,{children:"![](attachments/Pasted image 20230303143409.png)"}),"\n",(0,a.jsxs)(s.p,{children:["\u5728\u5e8f\u5217\u5316\u65f6\u4f1a\u8c03\u7528 ",(0,a.jsx)(s.code,{children:"put()"})," \u65b9\u6cd5\uff0c\u8fd9\u65f6\u5019\u4f1a\u89e6\u53d1 ",(0,a.jsx)(s.code,{children:"hashCode()"})," \u65b9\u6cd5\uff0chashCode \u5c5e\u6027\u503c\u4f1a\u88ab\u8bbe\u4e3a -1\uff0c\u7ecf\u8fc7 ",(0,a.jsx)(s.code,{children:"java.net.URL.hashCode()"})," \u4e2d\u5224\u65ad\uff0c\u4e0d\u4f1a\u89e6\u53d1\u540e\u7eed\u6d41\u7a0b\uff0c\u6240\u4ee5\u9700\u8981\u53cd\u5c04\u4fee\u6539 hashCode \u503c\u3002"]}),"\n",(0,a.jsxs)(s.p,{children:["ysoserial \u4e2d\u5b9e\u73b0\u4e86\u81ea\u5b9a\u4e49\u7684 ",(0,a.jsx)(s.code,{children:"URLStreamHandler"})," \u4f7f\u5f97\u751f\u6210 gadget \u65f6\u8c03\u7528\u81ea\u5b9a\u4e49 ",(0,a.jsx)(s.code,{children:"getHostAddress()"})," \u65b9\u6cd5\uff0c\u907f\u514d\u63d0\u524d\u89e6\u53d1dns\u67e5\u8be2\u3002"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"image-20240119095330796",src:n(52422).Z+"",width:"1306",height:"340"})}),"\n",(0,a.jsx)(s.h2,{id:"0x02-\u7c7b\u63a2\u6d4b",children:"0x02 \u7c7b\u63a2\u6d4b"}),"\n",(0,a.jsxs)(s.p,{children:["\u5728\u8c03\u7528 HashMap \u7684 ",(0,a.jsx)(s.code,{children:"putVal()"})," \u524d\u8c03\u7528\u4e86\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c\u800c\u5728 ",(0,a.jsx)(s.code,{children:"readObject()"})," \u4e2d\uff0c\u5f53\u7c7b\u4e0d\u5b58\u5728\u65f6\u4f1a\u629b\u51fa ",(0,a.jsx)(s.code,{children:"ClassNotFoundException"})," \u5f02\u5e38\uff0c\u4e5f\u5c31\u4e0d\u4f1a\u89e6\u53d1\u5230\u540e\u7eed\u7684\u8bf7\u6c42\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06 value \u503c\u63d2\u5165\u4e3a Class \u5bf9\u8c61\u5b9e\u73b0\u7c7b\u63a2\u6d4b\u3002"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-java",children:"K key = (K) s.readObject();\nV value = (V) s.readObject();\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"image-20240119100451779",src:n(39621).Z+"",width:"1540",height:"672"})}),"\n",(0,a.jsxs)(s.p,{children:["\u672c\u5730\u5df2\u6709\u7684\u7c7b\u53ef\u4ee5\u901a\u8fc7 ",(0,a.jsx)(s.code,{children:"Class.forName(className);"})," \u83b7\u53d6\uff0c\u5982\u679c\u60f3\u63a2\u6d4b\u4efb\u610f\u7c7b\u5462\uff1f\u53ef\u4ee5\u4f7f\u7528 javassist"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-java",children:"ClassPool.getDefault().makeClass(className).toClass();\n"})})]})}function h(e={}){const{wrapper:s}={...(0,c.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},61512:(e,s,n)=>{n.d(s,{Z:()=>a});const a=n.p+"assets/images/image-20240119092941838-971f06acf2bfdcb054fba53d695e220e.png"},52422:(e,s,n)=>{n.d(s,{Z:()=>a});const a=n.p+"assets/images/image-20240119095330796-dd3943bfae06e5211eb154d385bfa715.png"},39621:(e,s,n)=>{n.d(s,{Z:()=>a});const a=n.p+"assets/images/image-20240119100451779-e6491f5fff376fc62d756c085e77eca3.png"},11151:(e,s,n)=>{n.d(s,{Z:()=>i,a:()=>d});var a=n(67294);const c={},t=a.createContext(c);function d(e){const s=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),a.createElement(t.Provider,{value:s},e.children)}}}]);