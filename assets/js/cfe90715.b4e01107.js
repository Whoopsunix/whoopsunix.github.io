"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[7930],{50870:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>l,frontMatter:()=>c,metadata:()=>t,toc:()=>r});var n=i(85893),a=i(11151);const c={sidebar_position:1,tags:["CVE","Dubbo","Deserialization","Hessian2"]},o="CVE-2021-36163 Apache Dubbo Hessian2 \u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e GHSL-2021-095",t={id:"components/Dubbo/CVE-2021-36163",title:"CVE-2021-36163 Apache Dubbo Hessian2 \u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e GHSL-2021-095",description:"\u6982\u8ff0",source:"@site/docs/03-components/Dubbo/CVE-2021-36163.md",sourceDirName:"03-components/Dubbo",slug:"/components/Dubbo/CVE-2021-36163",permalink:"/docs/components/Dubbo/CVE-2021-36163",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/03-components/Dubbo/CVE-2021-36163.md",tags:[{label:"CVE",permalink:"/docs/tags/cve"},{label:"Dubbo",permalink:"/docs/tags/dubbo"},{label:"Deserialization",permalink:"/docs/tags/deserialization"},{label:"Hessian2",permalink:"/docs/tags/hessian-2"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["CVE","Dubbo","Deserialization","Hessian2"]},sidebar:"tutorialSidebar",previous:{title:"CVE-2021-36162 Apache Dubbo Mesh Yaml pre-auth \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e GHSL-2021-094",permalink:"/docs/components/Dubbo/CVE-2021-36162"},next:{title:"CVE-2021-37579 Apache Dubbo \u53cd\u5e8f\u5217\u5316\u5b89\u5168\u68c0\u67e5\u7ed5\u8fc7",permalink:"/docs/components/Dubbo/CVE-2021-37579"}},d={},r=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u5f71\u54cd\u7248\u672c",id:"\u5f71\u54cd\u7248\u672c",level:3},{value:"\u590d\u73b0\u5206\u6790",id:"\u590d\u73b0\u5206\u6790",level:2},{value:"\u8865\u4e01",id:"\u8865\u4e01",level:2}];function h(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"cve-2021-36163-apache-dubbo-hessian2-\u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-ghsl-2021-095",children:"CVE-2021-36163 Apache Dubbo Hessian2 \u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e GHSL-2021-095"}),"\n",(0,n.jsx)(s.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,n.jsx)(s.h3,{id:"\u5f71\u54cd\u7248\u672c",children:"\u5f71\u54cd\u7248\u672c"}),"\n",(0,n.jsx)(s.p,{children:"[2.7.0, 2.7.12]\u3001[3.0.0, 3.0.1]"}),"\n",(0,n.jsx)(s.h2,{id:"\u590d\u73b0\u5206\u6790",children:"\u590d\u73b0\u5206\u6790"}),"\n",(0,n.jsxs)(s.p,{children:["\u60ef\u4f8b\uff0c\u5148\u6765\u770b\u4e00\u4e0b ",(0,n.jsx)(s.a,{href:"https://lists.apache.org/thread/jyxw8w93z5csy2c68d2nx4pvvb8h4f69",children:"\u6f0f\u6d1e\u62ab\u9732"})," \uff0c\u8fd9\u4e2a\u95ee\u9898\u51fa\u5728\u7528\u6237\u53ef\u4ee5\u9009\u62e9 Hessian \u5728 HTTP \u4e0a\u5b9e\u73b0\uff0cPOST \u8bf7\u6c42\u4e3b\u4f53\u5c06\u76f4\u63a5\u4f20\u9012\u7ed9 ",(0,n.jsx)(s.code,{children:"HessianSkeleton"}),"\uff0c\u5e76\u4e14\u4e0d\u5b58\u5728\u5b89\u5168\u914d\u7f6e\uff0c\u5e76\u4e14 generic \u670d\u52a1\u59cb\u7ec8\u662f\u516c\u5f00\u7684\u3002"]}),"\n",(0,n.jsxs)(s.p,{children:["\u5df2\u77e5\u95ee\u9898\u51fa\u5728 ",(0,n.jsx)(s.code,{children:"HessianSkeleton"}),"\uff0c\u6240\u4ee5\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5230\u901a\u8fc7 ",(0,n.jsx)(s.code,{children:"org.apache.dubbo.rpc.protocol.hessian.HessianProtocol.HessianHandler#handle()"})," \u8c03\u7528\u4e86\u8be5\u65b9\u6cd5\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205101525309",src:i(60345).Z+"",width:"1918",height:"1236"})}),"\n",(0,n.jsxs)(s.p,{children:["\u8be5\u63a5\u53e3\u901a\u8fc7 ",(0,n.jsx)(s.code,{children:"org.apache.dubbo.remoting.http.servlet.DispatcherServlet#service()"})," \u8c03\u7528\uff0c\u8fd9\u91cc\u6211\u4eec\u770b\u5230\u901a\u8fc7\u8bf7\u6c42\u7aef\u53e3\u9009\u62e9\u5bf9\u5e94\u7684 handler\uff0c\u548c\u4e4b\u524d\u590d\u73b0\u65f6\u914d\u7f6e\u90fd\u5dee\u4e0d\u591a\uff0c\u5c0f\u6539\u4e00\u4e0b\u6362\u6210 hessian \u5c31\u884c\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205101709061",src:i(91932).Z+"",width:"1580",height:"466"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205101942897",src:i(16910).Z+"",width:"1846",height:"402"})}),"\n",(0,n.jsxs)(s.p,{children:["\u65ad\u70b9\u8c03\u8bd5 ",(0,n.jsx)(s.code,{children:"org.apache.dubbo.rpc.protocol.hessian.HessianProtocol.HessianHandler#handle()"})," \u65b9\u6cd5\uff0c\u5c06 POST \u65b9\u6cd5\u4f20\u5165\u7684\u8bf7\u6c42\u5bf9\u8c61\u7528\u4e8e\u53cd\u5e8f\u5217\u5316\uff0c\u5e76\u4e14\u4e0d\u5b58\u5728\u5b89\u5168 Factory \u8fc7\u6ee4\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205105852996",src:i(82396).Z+"",width:"2158",height:"1584"})}),"\n",(0,n.jsxs)(s.p,{children:["\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b58\u5728\u4e24\u4e2a Path\uff0c",(0,n.jsx)(s.code,{children:"/org.apache.dubbo.samples.http.api.DemoService"})," \u4e0d\u80fd\u89e6\u53d1\uff0c\u901a\u544a\u62ab\u9732\u7684",(0,n.jsx)(s.code,{children:"/org.apache.dubbo.samples.http.api.DemoService/generic"})," \u5374\u53ef\u4ee5\uff0c\u770b\u4e00\u770b ",(0,n.jsx)(s.code,{children:"exporterMap"})," \u662f\u600e\u4e48\u8d4b\u503c\u7684\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205103845388",src:i(92541).Z+"",width:"2176",height:"632"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"exporterMap"})," \u901a\u8fc7 ",(0,n.jsx)(s.code,{children:"org.apache.dubbo.rpc.protocol.hessian.HessianProtocol#doExport()"})," \u8d4b\u503c\uff0c\u524d\u540e\u6dfb\u52a0\u4e86\u4e24\u4e2a ",(0,n.jsx)(s.code,{children:"HessianSkeleton"})," \u5bf9\u8c61\uff0c\u7b2c\u4e00\u4e2a\u662f DemoService \uff0c\u6240\u4ee5\u6700\u540e\u53ea\u80fd\u8c03\u7528\u4ed6\u7684 ",(0,n.jsx)(s.code,{children:"sayHello"})," \u65b9\u6cd5\uff0c\u800c ",(0,n.jsx)(s.code,{children:"org.apache.dubbo.rpc.service.GenericService"})," \u662f\u5b58\u5728 ",(0,n.jsx)(s.code,{children:"$invoke"})," \u7684\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u5728\u5199 payload \u7684\u65f6\u5019\u7528\u5230\u4e86 ",(0,n.jsx)(s.code,{children:"$invoke"}),"\uff0c\u5e76\u4e14\u4f9d\u6b21\u5199\u5165\u4e86\u9700\u8981\u7684\u53c2\u6570\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205110551579",src:i(29758).Z+"",width:"2144",height:"846"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205110801161",src:i(17382).Z+"",width:"1222",height:"500"})}),"\n",(0,n.jsxs)(s.p,{children:["\u6240\u4ee5\u5b9a\u4e49\u4e00\u4e2a Object \u63a5\u53e3\uff0c\u53ea\u8981 payload \u7684\u53c2\u6570\u7c7b\u578b\u4e00\u81f4\u4e5f\u662f\u53ef\u4ee5\u89e6\u53d1\u7684\u3002\u90a3\u4e48\u5728 telnet \u53ef\u4ee5\u8fde\u63a5\u5230 dubbo \u7aef\u53e3\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5df2\u77e5\u63a5\u53e3\u540d\uff0c\u53ea\u9700\u8981\u7206\u7834\u53c2\u6570\u5c31\u80fd\u653b\u51fb\u4e86\uff0c\u8fd9\u4e5f\u662f\u5f88\u591a\u5de5\u5177\u5b9e\u73b0\u65f6\u7528\u5230\u7684\u53c2\u6570\u7206\u7834\u3002\u5f53\u7136\u8fd9\u5c31\u662f\u9898\u5916\u8bdd\u4e86\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528 ",(0,n.jsx)(s.code,{children:"$invoke"}),"\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205111254297",src:i(79030).Z+"",width:"842",height:"344"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205111604764",src:i(76311).Z+"",width:"806",height:"312"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205111328381",src:i(82234).Z+"",width:"1994",height:"910"})}),"\n",(0,n.jsx)(s.h2,{id:"\u8865\u4e01",children:"\u8865\u4e01"}),"\n",(0,n.jsx)(s.p,{children:"\u8bbe\u7f6e\u5b89\u5168 Factory"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"image-20240205110104544",src:i(16645).Z+"",width:"2060",height:"312"})})]})}function l(e={}){const{wrapper:s}={...(0,a.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},60345:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205101525309-531e13e5c82135222a5f82007fe4188c.png"},91932:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205101709061-efb0f6b5c182cb862942af1a4a4bd339.png"},16910:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205101942897-0185a79962f32382485b41f972d62ee3.png"},92541:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205103845388-7370a34ae1d9e5d04778c2175977480d.png"},82396:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205105852996-3e01754c56ea0632871d7301888a9cf2.png"},16645:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205110104544-7655013f1b5d76b7eb71b3e6d3d8d668.png"},29758:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205110551579-c362d36470a6b513d2878de2cdfdd662.png"},17382:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205110801161-76444f4ed5e8395bb1040417cfb9dbec.png"},79030:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205111254297-a0070263bba612552c25d1cc7f2c8f49.png"},82234:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205111328381-92292475746209656ad725eba6dbba7f.png"},76311:(e,s,i)=>{i.d(s,{Z:()=>n});const n=i.p+"assets/images/image-20240205111604764-5015b4d652afd11f9f90613c014c0847.png"},11151:(e,s,i)=>{i.d(s,{Z:()=>t,a:()=>o});var n=i(67294);const a={},c=n.createContext(a);function o(e){const s=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(c.Provider,{value:s},e.children)}}}]);