"use strict";(self.webpackChunkwhoopsunix_wiki=self.webpackChunkwhoopsunix_wiki||[]).push([[2039],{80893:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>t});var n=s(85893),o=s(11151);const i={sidebar_position:1,tags:["CVE","Dubbo","Deserialization","Hessian2"]},r="CVE-2021-30179 Apache Dubbo Generic filter \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e GHSL-2021-037 GHSL-2021-038",c={id:"components/Dubbo/CVE-2021-30179",title:"CVE-2021-30179 Apache Dubbo Generic filter \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e GHSL-2021-037 GHSL-2021-038",description:"\u6982\u8ff0",source:"@site/docs/03-components/Dubbo/CVE-2021-30179.md",sourceDirName:"03-components/Dubbo",slug:"/components/Dubbo/CVE-2021-30179",permalink:"/docs/components/Dubbo/CVE-2021-30179",draft:!1,unlisted:!1,editUrl:"https://github.com/Whoopsunix/whoopsunix.github.io/docs/03-components/Dubbo/CVE-2021-30179.md",tags:[{label:"CVE",permalink:"/docs/tags/cve"},{label:"Dubbo",permalink:"/docs/tags/dubbo"},{label:"Deserialization",permalink:"/docs/tags/deserialization"},{label:"Hessian2",permalink:"/docs/tags/hessian-2"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["CVE","Dubbo","Deserialization","Hessian2"]},sidebar:"tutorialSidebar",previous:{title:"CVE-2021-25641 \u53ef\u4fe1\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff08\u5f31\u9a8c\u8bc1\u5668\uff09GHSL-2021-035",permalink:"/docs/components/Dubbo/CVE-2021-25641"},next:{title:"CVE-2021-30180 Apache Dubbo Tag routing Yaml pre-auth \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e GHSL-2021-040\u3001GHSL-2021-041\u3001GHSL-2021-043",permalink:"/docs/components/Dubbo/CVE-2021-30180"}},l={},t=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u5f71\u54cd\u7248\u672c",id:"\u5f71\u54cd\u7248\u672c",level:3},{value:"\u590d\u73b0\u5206\u6790",id:"\u590d\u73b0\u5206\u6790",level:2},{value:"\u8865\u4e01",id:"\u8865\u4e01",level:2}];function p(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h1,{id:"cve-2021-30179-apache-dubbo-generic-filter-\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e-ghsl-2021-037-ghsl-2021-038",children:"CVE-2021-30179 Apache Dubbo Generic filter \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e GHSL-2021-037 GHSL-2021-038"}),"\n",(0,n.jsx)(a.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,n.jsx)(a.h3,{id:"\u5f71\u54cd\u7248\u672c",children:"\u5f71\u54cd\u7248\u672c"}),"\n",(0,n.jsx)(a.p,{children:"2.5.x\u3001[2.6.0, 2.6.8]\u3001[2.7.0, 2.7.9]"}),"\n",(0,n.jsx)(a.h2,{id:"\u590d\u73b0\u5206\u6790",children:"\u590d\u73b0\u5206\u6790"}),"\n",(0,n.jsxs)(a.p,{children:["\u9996\u5148\u770b\u4e00\u4e0b ",(0,n.jsx)(a.a,{href:"https://lists.apache.org/thread/980x0wb42tghghwmskpcm47fc77936pp",children:"\u6f0f\u6d1e\u62ab\u9732\u90ae\u4ef6"})," \uff0c\u95ee\u9898\u51fa\u5728 GenericFilter \u8fd9\u4e2a\u7c7b\uff0c\u5f53\u8c03\u7528 ",(0,n.jsx)(a.code,{children:"$invoke"})," \u6216 ",(0,n.jsx)(a.code,{children:"$invokeAsync"})," \u65b9\u6cd5\u65f6\u5982\u679c methodDesc \u4e3a ",(0,n.jsx)(a.code,{children:"Ljava/lang/String;[Ljava/lang/String;[Ljava/lang/Object;"})," \uff0c",(0,n.jsx)(a.code,{children:"generic"})," \u4e3a\u4e0b\u56fe\u5217\u51fa\u7684\u51e0\u4e2a\u4f1a\u8c03\u7528\u5b9e\u9645\u7b2c\u4e09\u4e2a\u5b57\u8282\u6570\u7ec4\u53cd\u5e8f\u5217\u5316\u3002"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20231122151343243",src:s(59679).Z+"",width:"2824",height:"534"})}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:"org.apache.dubbo.rpc.filter.GenericFilter"})," \u662f Dubbo \u6846\u67b6\u4e2d\u7684\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u7528\u4e8e\u5904\u7406\u6cdb\u5316\u8c03\u7528\uff08Generic Invocation\uff09\u3002\u6cdb\u5316\u8c03\u7528\u662f Dubbo \u63d0\u4f9b\u7684\u4e00\u79cd\u8c03\u7528\u65b9\u5f0f\uff0c\u5141\u8bb8\u8c03\u7528\u8005\u901a\u8fc7\u4f20\u9012\u65b9\u6cd5\u540d\u548c\u53c2\u6570\u5217\u8868\u7684\u65b9\u5f0f\uff0c\u800c\u65e0\u9700\u4f9d\u8d56\u670d\u52a1\u63d0\u4f9b\u65b9\u63d0\u4f9b\u7684\u63a5\u53e3\uff0c\u9002\u7528\u4e8e\u4e00\u4e9b\u52a8\u6001\u6027\u5f88\u9ad8\u7684\u573a\u666f\uff0c\u6bd4\u5982\u524d\u7aef\u901a\u8fc7\u52a8\u6001\u914d\u7f6e\u7684\u65b9\u5f0f\u8c03\u7528\u670d\u52a1\u3002"]}),"\n",(0,n.jsxs)(a.p,{children:["\u8fdb\u5165 ",(0,n.jsx)(a.code,{children:"invoke()"})," \u65b9\u6cd5\u9996\u5148\u5bf9\u65b9\u6cd5\u540d\uff0c\u53c2\u6570\u8fdb\u884c\u5224\u65ad"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20240129095544066",src:s(90167).Z+"",width:"1882",height:"1056"})}),"\n",(0,n.jsx)(a.p,{children:"\u4e4b\u540e\u5f53 generic \u4e0d\u4e3a\u7a7a\u65f6\u4f1a\u8fdb\u5165\u4e0d\u540c\u7684\u903b\u8f91\uff0c\u5373\u90ae\u4ef6\u6240\u62ab\u9732\u7684\u51e0\u79cd\u60c5\u51b5\u3002"}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20231122173733505",src:s(55493).Z+"",width:"2246",height:"1654"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20231122173817209",src:s(92315).Z+"",width:"1116",height:"382"})}),"\n",(0,n.jsxs)(a.p,{children:["\u6211\u4eec\u9009\u53d6\u5176\u4e2d\u7684 bean \u5206\u652f\uff0c\u8fdb\u5165 ",(0,n.jsx)(a.code,{children:"org.apache.dubbo.common.beanutil.JavaBeanSerializeUtil#deserialize()"})," \u65b9\u6cd5\u3002\u4e00\u6b65\u6b65\u8ddf\u8fdb\u5230 ",(0,n.jsx)(a.code,{children:"org.apache.dubbo.common.beanutil.JavaBeanSerializeUtil#deserializeInternal()"})," \uff0c\u7531\u4e8e\u6211\u4eec\u5728 ",(0,n.jsx)(a.code,{children:"GenericFilter#invoke()"})," \u65b9\u6cd5\u8c03\u7528\u65f6\u5b9a\u4e49\u4e3a JavaBeanDescriptor\uff0c\u6240\u4ee5\u6700\u7ec8\u8fdb\u5165 bean \u5206\u652f\uff0c\u89e6\u53d1\u6700\u7ec8\u7684 ",(0,n.jsx)(a.code,{children:"method.invoke()"})," \u65b9\u6cd5\u3002"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20231122174701303",src:s(17386).Z+"",width:"1428",height:"368"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20231122174459631",src:s(63999).Z+"",width:"2218",height:"1124"})}),"\n",(0,n.jsx)(a.h2,{id:"\u8865\u4e01",children:"\u8865\u4e01"}),"\n",(0,n.jsxs)(a.p,{children:["\u4ee5 ",(0,n.jsx)(a.code,{children:"bean"})," \u4e3a\u4f8b\uff0c\u5728\u8fdb\u5165 ",(0,n.jsx)(a.code,{children:"JavaBeanSerializeUtil#deserialize()"})," \u7684\u6d41\u7a0b\u540e\uff0c\u5f15\u5165 ",(0,n.jsx)(a.code,{children:"SerializeClassChecker"})," \u8fdb\u884c\u9ed1\u540d\u5355\u9a8c\u8bc1"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20240201114737231",src:s(724).Z+"",width:"1920",height:"1112"})}),"\n",(0,n.jsxs)(a.p,{children:["nativejava \u5219\u662f\u5728 ",(0,n.jsx)(a.code,{children:"org.apache.dubbo.rpc.support.ProtocolUtils"})," \u76f4\u63a5\u5224\u65ad\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u652f\u6301"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"image-20240201114813125",src:s(8255).Z+"",width:"1872",height:"590"})}),"\n",(0,n.jsx)(a.p,{children:"\u9ed1\u540d\u5355\u5982\u4e0b\uff1a"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"java\\.lang\\.RuntimeException true\nbsh. false\nch.qos.logback.core.db. false\nclojure. false\ncom.alibaba.citrus.springext.support.parser. false\ncom.alibaba.citrus.springext.util.SpringExtUtil. false\ncom.alibaba.druid.pool. false\ncom.alibaba.hotcode.internal.org.apache.commons.collections.functors. false\ncom.alipay.custrelation.service.model.redress. false\ncom.alipay.oceanbase.obproxy.druid.pool. false\ncom.caucho.config.types. false\ncom.caucho.hessian.test. false\ncom.caucho.naming. false\ncom.ibm.jtc.jax.xml.bind.v2.runtime.unmarshaller. false\ncom.ibm.xltxe.rnm1.xtq.bcel.util. false\ncom.mchange.v2.c3p0. false\ncom.mysql.jdbc.util. false\ncom.rometools.rome.feed. false\ncom.sun.corba.se.impl. false\ncom.sun.corba.se.spi.orbutil. false\ncom.sun.jndi.rmi. false\ncom.sun.jndi.toolkit. false\ncom.sun.org.apache.bcel.internal. false\ncom.sun.org.apache.xalan.internal. false\ncom.sun.rowset. false\ncom.sun.xml.internal.bind.v2. false\ncom.taobao.vipserver.commons.collections.functors. false\ngroovy.lang. false\njava.awt. false\njava.beans. false\njava\\.lang\\.ProcessBuilder false\njava\\.lang\\.Runtime false\njava.rmi.server. false\njava.security. false\njava\\.util\\.ServiceLoader false\njava\\.util\\.StringTokenizer false\njavassist.bytecode.annotation. false\njavassist\\.tools\\.web\\.Viewer false\njavassist.util.proxy. false\njavax.imageio. false\njavax.imageio.spi. false\njavax.management. false\njavax.media.jai.remote. false\njavax.naming. false\njavax.script. false\njavax.sound.sampled. false\njavax.swing. false\njavax.xml.transform. false\nnet.bytebuddy.dynamic.loading. false\noracle.jdbc.connector. false\noracle.jdbc.pool. false\norg.apache.aries.transaction.jms. false\norg.apache.bcel.util. false\norg.apache.carbondata.core.scan.expression. false\norg.apache.commons.beanutils. false\norg.apache.commons.codec.binary. false\norg.apache.commons.collections.functors. false\norg.apache.commons.collections4.functors. false\norg.apache.commons.codec. false\norg.apache.commons.configuration. false\norg.apache.commons.configuration2. false\norg.apache.commons.dbcp.datasources. false\norg.apache.commons.dbcp2.datasources. false\norg.apache.commons.fileupload.disk. false\norg.apache.ibatis.executor.loader. false\norg.apache.ibatis.javassist.bytecode. false\norg.apache.ibatis.javassist.tools. false\norg.apache.ibatis.javassist.util. false\norg.apache.ignite.cache. false\norg.apache.log.output.db. false\norg.apache.log4j.receivers.db. false\norg.apache.myfaces.view.facelets.el. false\norg.apache.openjpa.ee. false\norg.apache.openjpa.ee. false\norg.apache.shiro. false\norg.apache.tomcat.dbcp. false\norg.apache.velocity.runtime. false\norg.apache.velocity. false\norg.apache.wicket.util. false\norg.apache.xalan.xsltc.trax. false\norg.apache.xbean.naming.context. false\norg.apache.xpath. false\norg.apache.zookeeper. false\norg.aspectj. false\norg.codehaus.groovy.runtime. false\norg.datanucleus.store.rdbms.datasource.dbcp.datasources. false\norg.dom4j. false\norg.eclipse.jetty.util.log. false\norg.geotools.filter. false\norg.h2.value. false\norg.hibernate.tuple.component. false\norg.hibernate.type. false\norg.jboss.ejb3. false\norg.jboss.proxy.ejb. false\norg.jboss.resteasy.plugins.server.resourcefactory. false\norg.jboss.weld.interceptor.builder. false\norg.junit. false\norg.mockito.internal.creation.cglib. false\norg.mortbay.log. false\norg.mockito. false\norg.thymeleaf. false\norg.quartz. false\norg.springframework.aop.aspectj. false\norg\\.springframework\\.beans\\.BeanWrapperImpl$BeanPropertyHandler false\norg.springframework.beans.factory. false\norg.springframework.expression.spel. false\norg.springframework.jndi. false\norg.springframework.orm. false\norg.springframework.transaction. false\norg.yaml.snakeyaml.tokens. false\nognl. false\npstore.shaded.org.apache.commons.collections. false\nsun.print. false\nsun.rmi.server. false\nsun.rmi.transport. false\nweblogic.ejb20.internal. false\nweblogic.jms.common. false\n\n"})})]})}function d(e={}){const{wrapper:a}={...(0,o.a)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},59679:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20231122151343243-91e3f0877122cf046f77ed4e6dbd8104.png"},55493:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20231122173733505-b6033135a07ef5f6829212472c175988.png"},92315:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20231122173817209-d3bf51337c28c23b0b10e7e2359010cb.png"},63999:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20231122174459631-6770978efbf7b610c1bb19948dc9b312.png"},17386:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20231122174701303-dd478ad4ae7c84209525a1fc57d4e6a2.png"},90167:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20240129095544066-f767c04801e5d38b91b832f420343839.png"},724:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20240201114737231-d5dd6ea77465ac62c51b0f40977abca3.png"},8255:(e,a,s)=>{s.d(a,{Z:()=>n});const n=s.p+"assets/images/image-20240201114813125-332abc27609fb0254131ce269ab6838d.png"},11151:(e,a,s)=>{s.d(a,{Z:()=>c,a:()=>r});var n=s(67294);const o={},i=n.createContext(o);function r(e){const a=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(i.Provider,{value:a},e.children)}}}]);