<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-java/RASP/RASPBypass" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">RASP 绕过 Trick 🦖 Whoopsunix</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://whoopsunix.com/docs/java/RASP/RASPBypass"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="RASP 绕过 Trick 🦖 Whoopsunix"><meta data-rh="true" name="description" content="RASP 越来越多了，应用最多的是 Java 场景，其他语言大多是用的 c 实现了类似功能不参与讨论。从 JDK 1.5 开始，Java 提供了一种动态代理机制，允许代理检测在 JVM 中运行的服务，通过插桩的方式修改方法的字节码。简单来说就是 hook 系统的关键函数实现防护，通常将这类函数称为 Sink 点，参数来源函数称为 Source 点，产品形态决定了其在绕过思路上与 WAF 这类产品有很大的不同，举一些例子："><meta data-rh="true" property="og:description" content="RASP 越来越多了，应用最多的是 Java 场景，其他语言大多是用的 c 实现了类似功能不参与讨论。从 JDK 1.5 开始，Java 提供了一种动态代理机制，允许代理检测在 JVM 中运行的服务，通过插桩的方式修改方法的字节码。简单来说就是 hook 系统的关键函数实现防护，通常将这类函数称为 Sink 点，参数来源函数称为 Source 点，产品形态决定了其在绕过思路上与 WAF 这类产品有很大的不同，举一些例子："><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://whoopsunix.com/docs/java/RASP/RASPBypass"><link data-rh="true" rel="alternate" href="https://whoopsunix.com/docs/java/RASP/RASPBypass" hreflang="en"><link data-rh="true" rel="alternate" href="https://whoopsunix.com/docs/java/RASP/RASPBypass" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Whoopsunix RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Whoopsunix Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e447ecda.css">
<link rel="preload" href="/assets/js/runtime~main.f5635646.js" as="script">
<link rel="preload" href="/assets/js/main.9d340f36.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Whoopsunix</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/PPPYSO/">WIKI</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tag</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Whoopsunix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/PPPYSO/">PPPYSO</a><button aria-label="Expand sidebar category &#x27;PPPYSO&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/java-安全">Java 安全</a><button aria-label="Collapse sidebar category &#x27;Java 安全&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/java/named module/">JDK 17+ FreeMarker SSTI：从 CVE-2023-4450 复现引出 MethodHandle 句柄、named module 机制研究</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/java/RASP/RASPBypass">RASP</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/java/RASP/RASPBypass">RASP 绕过 Trick</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/components/">组件漏洞分析</a><button aria-label="Expand sidebar category &#x27;组件漏洞分析&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/readTeam/">RT Attack</a><button aria-label="Expand sidebar category &#x27;RT Attack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/DevOpsAttack/">DevOps Attack</a><button aria-label="Expand sidebar category &#x27;DevOps Attack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/java-安全"><span itemprop="name">Java 安全</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">RASP</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">RASP 绕过 Trick</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>RASP 绕过 Trick</h1>
<p>RASP 越来越多了，应用最多的是 Java 场景，其他语言大多是用的 c 实现了类似功能不参与讨论。从 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.instrument/java/lang/instrument/package-summary.html" target="_blank" rel="noopener noreferrer">JDK 1.5</a> 开始，Java 提供了一种动态代理机制，允  许代理检测在 JVM 中运行的服务，通过插桩的方式修改方法的字节码。简单来说就是 hook 系统的关键函数实现防护，通常将这类函数称为 Sink 点，参数来源函数称为 Source 点，产品形态决定了其在绕过思路上与 WAF 这类产品有很大的不同，举一些例子：</p>
<p>以 ysoserial 生成的 pyaload 为例，需要考虑两种类型漏洞的绕过 反序列化+命令执行，更复杂的攻击方式比如 JNDI 从检测顺序来看会经过 SSRF、JNDI、反序列化、RCE 等算法的检测，所以实际攻击时是需要灵活变换思路与之对抗的，并不是 &quot;一键 RCE&quot; 模式的 bypass 套路。</p>
<p>本文旨在介绍一下 RASP 这个产品是什么？实现时有什么通用问题？以及存在的绕过 Trick，所以不针对某个产品，交流为主。</p>
<p>之后关于 Hook 点的研究会同步到 <a href="https://github.com/Whoopsunix/PPPRASP" target="_blank" rel="noopener noreferrer">PPPRASP</a> 项目中，漏洞 Demo 见 <a href="https://github.com/Whoopsunix/JavaRce" target="_blank" rel="noopener noreferrer">JavaRce</a> 项目</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x01-与-waf-不太一样的参数绕过">0x01 与 WAF 不太一样的参数绕过<a href="#0x01-与-waf-不太一样的参数绕过" class="hash-link" aria-label="Direct link to 0x01 与 WAF 不太一样的参数绕过" title="Direct link to 0x01 与 WAF 不太一样的参数绕过">​</a></h2>
<p>先从最熟悉的 WAF 开篇，WAF 主要分析流量中的特征来过滤攻击，防护能力很大程度上依赖于特征库，所以一直以来关于 WAF 都存在着各种花式绕过，对于 SQL 注入、xss 有很大一部分 payload 在 RASP 场景下仍然适用，这里先介绍一下 RASP 处理参数的优缺点</p>
<ol>
<li>优点：RASP 能获取到最终 Sink 函数真实传入的参数，只要够底层，前面的各种编码绕过都是无效的。</li>
<li>缺点：无法关联到具体的 Source 参数，严  格来说这并不是一个完全不能解决的问题，毕竟还有另一个类似的产品 IAST ，但这确实也是 RASP 形成差异化的关键点。</li>
</ol>
<p>因为有第二点问题的存在，RASP 通常会检测进入 Sink 函数的参数。以 SQL 注入为例，因为可以拿到最终的 sql 语句，所以会引入选用词法、语法分析引擎进行处理，分析 sql 语句的结构是否因为用户输入而改变。但是这类引擎能力不会很强（性能损耗考虑），所以引出了破坏引擎分析结果的绕过思路，这部分绕过建议看 Glassy 师傅的文章 <a href="https://mp.weixin.qq.com/s/Co_PPJ79azyyolBu07Qz_g" target="_blank" rel="noopener noreferrer">突破语义分析的黑魔法</a> 讲的很详细，测试了几个引擎后发现效果很好。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x02-从命令注入代入-rasp-视角">0x02 从命令注入代入 RASP 视角<a href="#0x02-从命令注入代入-rasp-视角" class="hash-link" aria-label="Direct link to 0x02 从命令注入代入 RASP 视角" title="Direct link to 0x02 从命令注入代入 RASP 视角">​</a></h2>
<p>RASP 是怎么防护命令执行的呢？跟进 <code>Runtime.exec()</code> 方法，底层是 <code>ProcessBuilder</code> 再底层 <code>ProcessImpl</code> 更底层的 <code>forkandexec</code> 方法在早两年前是很有效的绕过思路，当时的 RASP 产品并没有 hook native 方法，目前基本都已经跟进 Hook 了。</p>
<p>另一个思路就是通过开启一个线程来执行命令，导致 RASP 失去该上下文堆栈的分析数据，使得算法失效， <a href="https://github.com/jvm-rasp/jrasp-agent" target="_blank" rel="noopener noreferrer">JRASP</a> 提供了解决思路，通过 <code>java.lang.InheritableThreadLocal</code>类在父线程创建子线程时，向子线程传递变量。</p>
<p>这俩方法似乎都已失效，但给我们提供了 RASP 绕过的两个方法论：</p>
<ol>
<li>寻找难以覆盖的 hook 点</li>
<li>构造在上下文堆栈中难处理的代码</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x03-寻找难以覆盖的-hook-点---输入输出流">0x03 寻找难以覆盖的 hook 点 - 输入输出流<a href="#0x03-寻找难以覆盖的-hook-点---输入输出流" class="hash-link" aria-label="Direct link to 0x03 寻找难以覆盖的 hook 点 - 输入输出流" title="Direct link to 0x03 寻找难以覆盖的 hook 点 - 输入输出流">​</a></h2>
<p>Java 提供了多种输入输出流的类和接口，主要是为了适应不同的输入输出需求和数据类型场景，根据需求可以大致的分类出以下情况：</p>
<ol>
<li>数据类型差异：字节流（Byte Stream）和字符流（Character Stream）</li>
<li>性能优化：缓冲输入输出流（如 <code>BufferedInputStream</code> 和 <code>BufferedOutputStream</code>）</li>
<li>数据去向：文件、网络套接字、内存、管道</li>
<li>标准化和扩展：Java 支持扩展性，允许开发人员创建自定义的输入输出流来满足特定需求</li>
</ol>
<p>比如这两个例子中都使用了 InputStreamReader 来读取文件，并且污染参数都为传入的 String 类型参数，未经处理直接 hook 的话在应用运行时将产生大量的误报，这是在生产环境中不可接受的误拦截。比如 Tomcat 等中间件在创建页面时就用到的 InputStream 执行类似的读写操作。</p>
<p><img loading="lazy" alt="image-20231018105112502" src="/assets/images/image-20231018105112502-358af60e820e02c3fb3a23ab2cf03ed6.png" width="733" height="333" class="img_ev3q"></p>
<p><img loading="lazy" alt="image-20231018104816496" src="/assets/images/image-20231018104816496-291f323745d05649de944b3a14a32e45.png" width="655" height="293" class="img_ev3q"></p>
<p>正是由于输入输出流的难处理，给了我们很大的操作空间，比如 CharArrayWriter 这个类，我们看到将文件路径 path 和内容 context 都通过 java.io.Writer 的实现类进行封装，然后对这两个流进行操作， 这种情况下会发生多重引用的问题，如果没有特殊处理就会丢失文件内容。</p>
<p><img loading="lazy" alt="image-20231018105534318" src="/assets/images/image-20231018105534318-ff8be732f59a68b8430e73c67bc7ee74.png" width="823" height="207" class="img_ev3q"></p>
<p>还有哪些操作用到了流处理吗？线程 -&gt; 管道也同样可以读写文件，具体代码见 <a href="https://github.com/Whoopsunix/JavaRce" target="_blank" rel="noopener noreferrer">JavaRce</a> 项目。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x04-构造在上下文堆栈中难处理的代码---filed-的运用">0x04 构造在上下文堆栈中难处理的代码 - Filed 的运用<a href="#0x04-构造在上下文堆栈中难处理的代码---filed-的运用" class="hash-link" aria-label="Direct link to 0x04 构造在上下文堆栈中难处理的代码 - Filed 的运用" title="Direct link to 0x04 构造在上下文堆栈中难处理的代码 - Filed 的运用">​</a></h2>
<p>构造在上下文堆栈中难处理的代码算是一个比较复杂的利用，需要对 RASP 技术比较了解，介绍一个比较简单的且能在工具化时用到的 Trick。</p>
<p>以 Tomcat 环境下注入 Listener 内存马为例，大多数demo都直接用的 <code>org.apache.catalina.core.StandardContext#addApplicationEventListener()</code> 方法添加恶意对象，实际上可以通过反射获取 <code>applicationEventListenersList</code> 数组添加恶意对象。这时候我们调用的 <code>List.add()</code> 就是再正常不过的操作，并且集合操作广泛存在于应用中，通常不会作为 hook 点存在，因此规避算法。</p>
<p><img loading="lazy" alt="image-20240321162432130" src="/assets/images/image-20240321162432130-712e10bfab3bf95ee251db13a4bf516a.png" width="1502" height="660" class="img_ev3q"></p>
<p>当然内存马不是一个单独存在的漏洞，需要配合反序列化、远程加载等漏洞，并且如果只是最基本的执行命令的内存马同样会被检测， 可以用代理内存马，寻求内网突破或者配合第三点中介绍的的写入文件。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="防护思路">防护思路<a href="#防护思路" class="hash-link" aria-label="Direct link to 防护思路" title="Direct link to 防护思路">​</a></h3>
<p>既然提到可以利用 Filed 的绕过这个问题，也讲一下防护思路叭。其实很简单，内存马本质就是加载了一个恶意类，所以可以将防护思路转移到类加载检测上，比如检测是否来自敏感 classloader 调用、是否存在本地 class 文件。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/java">Java</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/rasp">RASP</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/bypass">Bypass</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Whoopsunix/whoopsunix.github.io/docs/02-java/RASP/RASPBypass.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/java/named module/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">JDK 17+ FreeMarker SSTI：从 CVE-2023-4450 复现引出 MethodHandle 句柄、named module   机制研究</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/components/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">组件漏洞分析</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#0x01-与-waf-不太一样的参数绕过" class="table-of-contents__link toc-highlight">0x01 与 WAF 不太一样的参数绕过</a></li><li><a href="#0x02-从命令注入代入-rasp-视角" class="table-of-contents__link toc-highlight">0x02 从命令注入代入 RASP 视角</a></li><li><a href="#0x03-寻找难以覆盖的-hook-点---输入输出流" class="table-of-contents__link toc-highlight">0x03 寻找难以覆盖的 hook 点 - 输入输出流</a></li><li><a href="#0x04-构造在上下文堆栈中难处理的代码---filed-的运用" class="table-of-contents__link toc-highlight">0x04 构造在上下文堆栈中难处理的代码 - Filed 的运用</a><ul><li><a href="#防护思路" class="table-of-contents__link toc-highlight">防护思路</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Whoopsunix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Whoopsunix © 2024</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f5635646.js"></script>
<script src="/assets/js/main.9d340f36.js"></script>
</body>
</html>